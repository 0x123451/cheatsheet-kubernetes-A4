-*- mode:org; fill-column:70; coding:utf-8;  -*-
#+SEQ_TODO: TODO HALF ASSIGN | DONE CANCELED BYPASS DELEGATE DEFERRED
* [#A] Kubernets                                                  :IMPORTANT:
https://github.com/DennyZhang/cheatsheet-kubernetes-A4

k8s provides declarative primitives for the “desired state”
- Self-healing
- Horizontal scaling
- Automatic binpacking
- Service discovery and load balancing
** Names of certificates files
https://github.com/kubernetes/kubeadm/blob/master/docs/design/design_v1.9.md
Names of certificates files:
ca.crt, ca.key (CA certificate)
apiserver.crt, apiserver.key (API server certificate)
apiserver-kubelet-client.crt, apiserver-kubelet-client.key (client certificate for the apiservers to connect to the kubelets securely)
sa.pub, sa.key (a private key for signing ServiceAccount )
front-proxy-ca.crt, front-proxy-ca.key (CA for the front proxy)
front-proxy-client.crt, front-proxy-client.key (client cert for the front proxy client)
** DONE [#A] k8s yaml file
  CLOSED: [2017-12-01 Fri 22:45]
http://containertutorials.com/get_started_kubernetes/k8s_example.html
https://www.mirantis.com/blog/introduction-to-yaml-creating-a-kubernetes-deployment/
https://kubernetes.io/docs/concepts/storage/volumes/#emptydir
** TODO update k8s cheatsheet github: https://github.com/alex1x/kubernetes-cheatsheet
** [#A] web page: 2.1 设计理念 · Kubernetes指南
https://kubernetes.feisky.xyz/architecture/concepts.html
*** webcontent                                                     :noexport:
#+begin_example
Location: https://kubernetes.feisky.xyz/architecture/concepts.html
[                    ]

  * Kubernetes指南
  *
  * 前言
  * 1. Kubernetes简介
      + 1.1 基本概念
      + 1.2 Kubernetes 101
      + 1.3 Kubernetes 201
      + 1.4 Kubernetes集群
  * 核心原理
  * 2. 核心原理
      + 2.1 设计理念
      + 2.2 主要概念
          o Pod
          o Namespace
          o Node
          o Service
          o Volume
          o Persistent Volume
          o Deployment
          o Secret
          o StatefulSet
          o DaemonSet
          o ServiceAccount
          o ReplicationController和ReplicaSet
          o Job
          o CronJob
          o SecurityContext和PSP
          o Resource Quota
          o Horizontal Pod Autoscaling
          o Network Policy
          o Ingress
          o ThirdPartyResources
          o ConfigMap
  * 3. 核心组件
      + 3.1 etcd
      + 3.2 API Server
          o 工作原理
      + 3.3 Scheduler
          o 工作原理
      + 3.4 Controller Manager
          o 工作原理
      + 3.5 kubelet
          o 工作原理
          o Container Runtime
      + 3.6 kube-proxy
          o 工作原理
      + 3.7 Kube DNS
          o 工作原理
      + 3.8 Federation
      + 3.9 kubeadm
      + 3.10 hyperkube
      + 3.11 kubectl
  * 4. 部署配置
      + 4.1 单机部署
      + 4.2 集群部署
          o kubeadm
          o kargo
          o Frakti+Hyper
          o CentOS手动部署
      + 4.3 kubectl客户端
      + 4.4 附加组件
          o Dashboard
          o Heapster
          o EFK
      + 4.5 推荐配置
  * 插件指南
  * 5. 插件扩展
      + 5.1 访问控制
          o RBAC授权
          o 准入控制
      + 5.2 网络
          o 网络模型和插件
          o CNI
              # CNI介绍
              # Flannel
              # Weave
              # Contiv
              # Calico
              # SR-IOV
              # Romana
              # OpenContrail
              # CNI Plugin Chains
      + 5.3 Volume插件
          o glusterfs
      + 5.4 Container Runtime Interface
      + 5.5 Network Policy
      + 5.6 Ingress Controller
          o Traefik
              # Traefik Ingress
              # 负载测试
              # 网络测试
              # 边缘节点配置
          o minikube Ingress
      + 5.7 Cloud Provider
      + 5.8 Scheduler扩展
  * 实践案例
  * 6. 应用管理
      + 6.1 滚动升级
      + 6.2 Helm
          o Helm参考
      + 6.3 Draft
      + 6.4 Operator
      + 6.5 Deis workflow
      + 6.6 Kompose
  * 7. 实践案例
      + 监控
      + 日志
      + 高可用
      + 调试
      + 端口映射
      + 端口转发
      + GPU
      + 容器安全
  * 开发与社区贡献
  * 8. 开发指南
      + 8.1 开发环境搭建
      + 8.2 单元测试和集成测试
      + 8.3 社区贡献
  * 附录
  * 9. 附录
      + 9.1 awesome-docker
      + 9.2 awesome-kubernetes
      + 9.3 Kubernetes ecosystem
      + 9.4 FAQ
      + 9.5 参考文档
  *
  * 本書使用 GitBook 釋出

2.1 设计理念

TreeviewCopyright © Pengfei Ni all right reserved, powered by aleen42

  * Kubernetes的设计理念
      +
          o Kubernetes设计理念与分布式系统
          o API设计原则
          o 控制机制设计原则
      + Kubernetes的核心技术概念和API对象
          o Pod
          o 复制控制器（Replication Controller，RC）
          o 副本集（Replica Set，RS）
          o 部署(Deployment)
          o 服务（Service）
          o 任务（Job）
          o 后台支撑服务集（DaemonSet）
          o 有状态服务集（PetSet）
          o 集群联邦（Federation）
          o 存储卷（Volume）
          o 持久存储卷（Persistent Volume，PV）和持久存储卷声明（Persistent Volume Claim，PVC）
          o 节点（Node）
          o 密钥对象（Secret）
          o 用户帐户（User Account）和服务帐户（Service Account）
          o 名字空间（Namespace）
          o RBAC访问授权
      + 总结

Kubernetes的设计理念

Kubernetes设计理念与分布式系统

分析和理解Kubernetes的设计理念可以使我们更深入地了解Kubernetes系统，更好地利用它管理分布式部署的云
原生应用，另一方面也可以让我们借鉴其在分布式系统设计方面的经验。

API设计原则

对于云计算系统，系统API实际上处于系统设计的统领地位，正如本文前面所说，K8s集群系统每支持一项新功能
，引入一项新技术，一定会新引入对应的API对象，支持对该功能的管理操作，理解掌握的API，就好比抓住了K8s
系统的牛鼻子。K8s系统API的设计有以下几条原则：

 1. 所有API应该是声明式的。正如前文所说，声明式的操作，相对于命令式操作，对于重复操作的效果是稳定的
    ，这对于容易出现数据丢失或重复的分布式环境来说是很重要的。另外，声明式操作更容易被用户使用，可
    以使系统向用户隐藏实现的细节，隐藏实现的细节的同时，也就保留了系统未来持续优化的可能性。此外，
    声明式的API，同时隐含了所有的API对象都是名词性质的，例如Service、Volume这些API都是名词，这些名
    词描述了用户所期望得到的一个目标分布式对象。
 2. API对象是彼此互补而且可组合的。这里面实际是鼓励API对象尽量实现面向对象设计时的要求，即“高内聚，
    松耦合”，对业务相关的概念有一个合适的分解，提高分解出来的对象的可重用性。事实上，K8s这种分布式
    系统管理平台，也是一种业务系统，只不过它的业务就是调度和管理容器服务。
 3. 高层API以操作意图为基础设计。如何能够设计好API，跟如何能用面向对象的方法设计好应用系统有相通的
    地方，高层设计一定是从业务出发，而不是过早的从技术实现出发。因此，针对K8s的高层API设计，一定是
    以K8s的业务为基础出发，也就是以系统调度管理容器的操作意图为基础设计。
 4. 低层API根据高层API的控制需要设计。设计实现低层API的目的，是为了被高层API使用，考虑减少冗余、提
    高重用性的目的，低层API的设计也要以需求为基础，要尽量抵抗受技术实现影响的诱惑。
 5. 尽量避免简单封装，不要有在外部API无法显式知道的内部隐藏的机制。简单的封装，实际没有提供新的功能
    ，反而增加了对所封装API的依赖性。内部隐藏的机制也是非常不利于系统维护的设计方式，例如PetSet和
    ReplicaSet，本来就是两种Pod集合，那么K8s就用不同API对象来定义它们，而不会说只用同一个ReplicaSet
    ，内部通过特殊的算法再来区分这个ReplicaSet是有状态的还是无状态。
 6. API操作复杂度与对象数量成正比。这一条主要是从系统性能角度考虑，要保证整个系统随着系统规模的扩大
    ，性能不会迅速变慢到无法使用，那么最低的限定就是API的操作复杂度不能超过O(N)，N是对象的数量，否
    则系统就不具备水平伸缩性了。
 7. API对象状态不能依赖于网络连接状态。由于众所周知，在分布式环境下，网络连接断开是经常发生的事情，
    因此要保证API对象状态能应对网络的不稳定，API对象的状态就不能依赖于网络连接状态。
 8. 尽量避免让操作机制依赖于全局状态，因为在分布式系统中要保证全局状态的同步是非常困难的。

控制机制设计原则

  * 控制逻辑应该只依赖于当前状态。这是为了保证分布式系统的稳定可靠，对于经常出现局部错误的分布式系
    统，如果控制逻辑只依赖当前状态，那么就非常容易将一个暂时出现故障的系统恢复到正常状态，因为你只
    要将该系统重置到某个稳定状态，就可以自信的知道系统的所有控制逻辑会开始按照正常方式运行。
  * 假设任何错误的可能，并做容错处理。在一个分布式系统中出现局部和临时错误是大概率事件。错误可能来
    自于物理系统故障，外部系统故障也可能来自于系统自身的代码错误，依靠自己实现的代码不会出错来保证
    系统稳定其实也是难以实现的，因此要设计对任何可能错误的容错处理。
  * 尽量避免复杂状态机，控制逻辑不要依赖无法监控的内部状态。因为分布式系统各个子系统都是不能严格通
    过程序内部保持同步的，所以如果两个子系统的控制逻辑如果互相有影响，那么子系统就一定要能互相访问
    到影响控制逻辑的状态，否则，就等同于系统里存在不确定的控制逻辑。
  * 假设任何操作都可能被任何操作对象拒绝，甚至被错误解析。由于分布式系统的复杂性以及各子系统的相对
    独立性，不同子系统经常来自不同的开发团队，所以不能奢望任何操作被另一个子系统以正确的方式处理，
    要保证出现错误的时候，操作级别的错误不会影响到系统稳定性。
  * 每个模块都可以在出错后自动恢复。由于分布式系统中无法保证系统各个模块是始终连接的，因此每个模块
    要有自我修复的能力，保证不会因为连接不到其他模块而自我崩溃。
  * 每个模块都可以在必要时优雅地降级服务。所谓优雅地降级服务，是对系统鲁棒性的要求，即要求在设计实
    现模块时划分清楚基本功能和高级功能，保证基本功能不会依赖高级功能，这样同时就保证了不会因为高级
    功能出现故障而导致整个模块崩溃。根据这种理念实现的系统，也更容易快速地增加新的高级功能，以为不
    必担心引入高级功能影响原有的基本功能。

Kubernetes的核心技术概念和API对象

API对象是K8s集群中的管理操作单元。K8s集群系统每支持一项新功能，引入一项新技术，一定会新引入对应的
API对象，支持对该功能的管理操作。例如副本集Replica Set对应的API对象是RS。

每个API对象都有3大类属性：元数据metadata、规范spec和状态status。元数据是用来标识API对象的，每个对象
都至少有3个元数据：namespace，name和uid；除此以外还有各种各样的标签labels用来标识和匹配不同的对象，
例如用户可以用标签env来标识区分不同的服务部署环境，分别用env=dev、env=testing、env=production来标识
开发、测试、生产的不同服务。规范描述了用户期望K8s集群中的分布式系统达到的理想状态（Desired State）
，例如用户可以通过复制控制器Replication Controller设置期望的Pod副本数为3；status描述了系统实际当前
达到的状态（Status），例如系统当前实际的Pod副本数为2；那么复制控制器当前的程序逻辑就是自动启动新的
Pod，争取达到副本数为3。

K8s中所有的配置都是通过API对象的spec去设置的，也就是用户通过配置系统的理想状态来改变系统，这是k8s重
要设计理念之一，即所有的操作都是声明式（Declarative）的而不是命令式（Imperative）的。声明式操作在分
布式系统中的好处是稳定，不怕丢操作或运行多次，例如设置副本数为3的操作运行多次也还是一个结果，而给副
本数加1的操作就不是声明式的，运行多次结果就错了。

Pod

K8s有很多技术概念，同时对应很多API对象，最重要的也是最基础的是微服务Pod。Pod是在K8s集群中运行部署应
用或服务的最小单元，它是可以支持多容器的。Pod的设计理念是支持多个容器在一个Pod中共享网络地址和文件
系统，可以通过进程间通信和文件共享这种简单高效的方式组合完成服务。Pod对多容器的支持是K8s最基础的设
计理念。比如你运行一个操作系统发行版的软件仓库，一个Nginx容器用来发布软件，另一个容器专门用来从源仓
库做同步，这两个容器的镜像不太可能是一个团队开发的，但是他们一块儿工作才能提供一个微服务；这种情况
下，不同的团队各自开发构建自己的容器镜像，在部署的时候组合成一个微服务对外提供服务。

Pod是K8s集群中所有业务类型的基础，可以看作运行在K8s集群中的小机器人，不同类型的业务就需要不同类型的
小机器人去执行。目前K8s中的业务主要可以分为长期伺服型（long-running）、批处理型（batch）、节点后台
支撑型（node-daemon）和有状态应用型（stateful application）；分别对应的小机器人控制器为Deployment、
Job、DaemonSet和PetSet，本文后面会一一介绍。

复制控制器（Replication Controller，RC）

RC是K8s集群中最早的保证Pod高可用的API对象。通过监控运行中的Pod来保证集群中运行指定数目的Pod副本。指
定的数目可以是多个也可以是1个；少于指定数目，RC就会启动运行新的Pod副本；多于指定数目，RC就会杀死多
余的Pod副本。即使在指定数目为1的情况下，通过RC运行Pod也比直接运行Pod更明智，因为RC也可以发挥它高可
用的能力，保证永远有1个Pod在运行。RC是K8s较早期的技术概念，只适用于长期伺服型的业务类型，比如控制小
机器人提供高可用的Web服务。

副本集（Replica Set，RS）

RS是新一代RC，提供同样的高可用能力，区别主要在于RS后来居上，能支持更多种类的匹配模式。副本集对象一
般不单独使用，而是作为Deployment的理想状态参数使用。

部署(Deployment)

部署表示用户对K8s集群的一次更新操作。部署是一个比RS应用模式更广的API对象，可以是创建一个新的服务，
更新一个新的服务，也可以是滚动升级一个服务。滚动升级一个服务，实际是创建一个新的RS，然后逐渐将新RS
中副本数增加到理想状态，将旧RS中的副本数减小到0的复合操作；这样一个复合操作用一个RS是不太好描述的，
所以用一个更通用的Deployment来描述。以K8s的发展方向，未来对所有长期伺服型的的业务的管理，都会通过
Deployment来管理。

服务（Service）

RC、RS和Deployment只是保证了支撑服务的微服务Pod的数量，但是没有解决如何访问这些服务的问题。一个Pod
只是一个运行服务的实例，随时可能在一个节点上停止，在另一个节点以一个新的IP启动一个新的Pod，因此不能
以确定的IP和端口号提供服务。要稳定地提供服务需要服务发现和负载均衡能力。服务发现完成的工作，是针对
客户端访问的服务，找到对应的的后端服务实例。在K8s集群中，客户端需要访问的服务就是Service对象。每个
Service会对应一个集群内部有效的虚拟IP，集群内部通过虚拟IP访问一个服务。在K8s集群中微服务的负载均衡
是由Kube-proxy实现的。Kube-proxy是K8s集群内部的负载均衡器。它是一个分布式代理服务器，在K8s的每个节
点上都有一个；这一设计体现了它的伸缩性优势，需要访问服务的节点越多，提供负载均衡能力的Kube-proxy就
越多，高可用节点也随之增多。与之相比，我们平时在服务器端做个反向代理做负载均衡，还要进一步解决反向
代理的负载均衡和高可用问题。

任务（Job）

Job是K8s用来控制批处理型任务的API对象。批处理业务与长期伺服业务的主要区别是批处理业务的运行有头有尾
，而长期伺服业务在用户不停止的情况下永远运行。Job管理的Pod根据用户的设置把任务成功完成就自动退出了
。成功完成的标志根据不同的spec.completions策略而不同：单Pod型任务有一个Pod成功就标志完成；定数成功
型任务保证有N个任务全部成功；工作队列型任务根据应用确认的全局成功而标志成功。

后台支撑服务集（DaemonSet）

长期伺服型和批处理型服务的核心在业务应用，可能有些节点运行多个同类业务的Pod，有些节点上又没有这类
Pod运行；而后台支撑型服务的核心关注点在K8s集群中的节点（物理机或虚拟机），要保证每个节点上都有一个
此类Pod运行。节点可能是所有集群节点也可能是通过nodeSelector选定的一些特定节点。典型的后台支撑型服务
包括，存储，日志和监控等在每个节点上支持K8s集群运行的服务。

有状态服务集（PetSet）

K8s在1.3版本里发布了Alpha版的PetSet功能。在云原生应用的体系里，有下面两组近义词；第一组是无状态（
stateless）、牲畜（cattle）、无名（nameless）、可丢弃（disposable）；第二组是有状态（stateful）、宠
物（pet）、有名（having name）、不可丢弃（non-disposable）。RC和RS主要是控制提供无状态服务的，其所
控制的Pod的名字是随机设置的，一个Pod出故障了就被丢弃掉，在另一个地方重启一个新的Pod，名字变了、名字
和启动在哪儿都不重要，重要的只是Pod总数；而PetSet是用来控制有状态服务，PetSet中的每个Pod的名字都是
事先确定的，不能更改。PetSet中Pod的名字的作用，并不是《千与千寻》的人性原因，而是关联与该Pod对应的
状态。

对于RC和RS中的Pod，一般不挂载存储或者挂载共享存储，保存的是所有Pod共享的状态，Pod像牲畜一样没有分别
（这似乎也确实意味着失去了人性特征）；对于PetSet中的Pod，每个Pod挂载自己独立的存储，如果一个Pod出现
故障，从其他节点启动一个同样名字的Pod，要挂载上原来Pod的存储继续以它的状态提供服务。

适合于PetSet的业务包括数据库服务MySQL和PostgreSQL，集群化管理服务Zookeeper、etcd等有状态服务。
PetSet的另一种典型应用场景是作为一种比普通容器更稳定可靠的模拟虚拟机的机制。传统的虚拟机正是一种有
状态的宠物，运维人员需要不断地维护它，容器刚开始流行时，我们用容器来模拟虚拟机使用，所有状态都保存
在容器里，而这已被证明是非常不安全、不可靠的。使用PetSet，Pod仍然可以通过漂移到不同节点提供高可用，
而存储也可以通过外挂的存储来提供高可靠性，PetSet做的只是将确定的Pod与确定的存储关联起来保证状态的连
续性。PetSet还只在Alpha阶段，后面的设计如何演变，我们还要继续观察。

集群联邦（Federation）

K8s在1.3版本里发布了beta版的Federation功能。在云计算环境中，服务的作用距离范围从近到远一般可以有：
同主机（Host，Node）、跨主机同可用区（Available Zone）、跨可用区同地区（Region）、跨地区同服务商（
Cloud Service Provider）、跨云平台。K8s的设计定位是单一集群在同一个地域内，因为同一个地区的网络性能
才能满足K8s的调度和计算存储连接要求。而联合集群服务就是为提供跨Region跨服务商K8s集群服务而设计的。

每个K8s Federation有自己的分布式存储、API Server和Controller Manager。用户可以通过Federation的API
Server注册该Federation的成员K8s Cluster。当用户通过Federation的API Server创建、更改API对象时，
Federation API Server会在自己所有注册的子K8s Cluster都创建一份对应的API对象。在提供业务请求服务时，
K8s Federation会先在自己的各个子Cluster之间做负载均衡，而对于发送到某个具体K8s Cluster的业务请求，
会依照这个K8s Cluster独立提供服务时一样的调度模式去做K8s Cluster内部的负载均衡。而Cluster之间的负载
均衡是通过域名服务的负载均衡来实现的。

所有的设计都尽量不影响K8s Cluster现有的工作机制，这样对于每个子K8s集群来说，并不需要更外层的有一个
K8s Federation，也就是意味着所有现有的K8s代码和机制不需要因为Federation功能有任何变化。

存储卷（Volume）

K8s集群中的存储卷跟Docker的存储卷有些类似，只不过Docker的存储卷作用范围为一个容器，而K8s的存储卷的
生命周期和作用范围是一个Pod。每个Pod中声明的存储卷由Pod中的所有容器共享。K8s支持非常多的存储卷类型
，特别的，支持多种公有云平台的存储，包括AWS，Google和Azure云；支持多种分布式存储包括GlusterFS和Ceph
；也支持较容易使用的主机本地目录hostPath和NFS。K8s还支持使用Persistent Volume Claim即PVC这种逻辑存
储，使用这种存储，使得存储的使用者可以忽略后台的实际存储技术（例如AWS，Google或GlusterFS和Ceph），
而将有关存储实际技术的配置交给存储管理员通过Persistent Volume来配置。

持久存储卷（Persistent Volume，PV）和持久存储卷声明（Persistent Volume Claim，PVC）

PV和PVC使得K8s集群具备了存储的逻辑抽象能力，使得在配置Pod的逻辑里可以忽略对实际后台存储技术的配置，
而把这项配置的工作交给PV的配置者，即集群的管理者。存储的PV和PVC的这种关系，跟计算的Node和Pod的关系
是非常类似的；PV和Node是资源的提供者，根据集群的基础设施变化而变化，由K8s集群管理员配置；而PVC和Pod
是资源的使用者，根据业务服务的需求变化而变化，有K8s集群的使用者即服务的管理员来配置。

节点（Node）

K8s集群中的计算能力由Node提供，最初Node称为服务节点Minion，后来改名为Node。K8s集群中的Node也就等同
于Mesos集群中的Slave节点，是所有Pod运行所在的工作主机，可以是物理机也可以是虚拟机。不论是物理机还是
虚拟机，工作主机的统一特征是上面要运行kubelet管理节点上运行的容器。

密钥对象（Secret）

Secret是用来保存和传递密码、密钥、认证凭证这些敏感信息的对象。使用Secret的好处是可以避免把敏感信息
明文写在配置文件里。在K8s集群中配置和使用服务不可避免的要用到各种敏感信息实现登录、认证等功能，例如
访问AWS存储的用户名密码。为了避免将类似的敏感信息明文写在所有需要使用的配置文件中，可以将这些信息存
入一个Secret对象，而在配置文件中通过Secret对象引用这些敏感信息。这种方式的好处包括：意图明确，避免
重复，减少暴漏机会。

用户帐户（User Account）和服务帐户（Service Account）

顾名思义，用户帐户为人提供账户标识，而服务账户为计算机进程和K8s集群中运行的Pod提供账户标识。用户帐
户和服务帐户的一个区别是作用范围；用户帐户对应的是人的身份，人的身份与服务的namespace无关，所以用户
账户是跨namespace的；而服务帐户对应的是一个运行中程序的身份，与特定namespace是相关的。

名字空间（Namespace）

名字空间为K8s集群提供虚拟的隔离作用，K8s集群初始有两个名字空间，分别是默认名字空间default和系统名字
空间kube-system，除此以外，管理员可以可以创建新的名字空间满足需要。

RBAC访问授权

K8s在1.3版本中发布了alpha版的基于角色的访问控制（Role-based Access Control，RBAC）的授权模式。相对
于基于属性的访问控制（Attribute-based Access Control，ABAC），RBAC主要是引入了角色（Role）和角色绑
定（RoleBinding）的抽象概念。在ABAC中，K8s集群中的访问策略只能跟用户直接关联；而在RBAC中，访问策略
可以跟某个角色关联，具体的用户在跟一个或多个角色相关联。显然，RBAC像其他新功能一样，每次引入新功能
，都会引入新的API对象，从而引入新的概念抽象，而这一新的概念抽象一定会使集群服务管理和使用更容易扩展
和重用。

总结

从K8s的系统架构、技术概念和设计理念，我们可以看到K8s系统最核心的两个设计理念：一个是容错性，一个是
易扩展性。容错性实际是保证K8s系统稳定性和安全性的基础，易扩展性是保证K8s对变更友好，可以快速迭代增
加新功能的基础。

[1] http://www.infoq.com/cn/articles/kubernetes-and-cloud-native-applications-part01

Kubernetes Handbook           Updated @ 2017-06-10 10:15:31

results matching ""

No results matching ""

#+end_example
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO Setting up MySQL Replication Clusters in Kubernetes: https://blog.kublr.com/setting-up-mysql-replication-clusters-in-kubernetes-ab7cbac113a5
** TODO MySQL on Docker: Running Galera Cluster on Kubernetes
https://severalnines.com/blog/mysql-docker-running-galera-cluster-kubernetes
** TODO Try Functions as a Service - a serverless framework for Docker & Kubernetes http://docs.get-faas.com/
https://blog.alexellis.io/first-faas-python-function/
** TODO [#A] k8s clustering elasticsearch
https://blog.alexellis.io/kubernetes-kubeadm-video/
** TODO k8s scale with redis
** TODO k8s scale with mysqld
** TODO [#A] k8s: https://5pi.de/2016/11/20/15-producation-grade-kubernetes-cluster/
** TODO Try kops with k8s
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO k8s free course: https://classroom.udacity.com/courses/ud615
** TODO feedbackup for k8s study project
Aaron Mulholland [1:18 AM]
So it looks pretty good. Got some good concepts in early on. Couple of suggestions for further work;

Potentially the following scenarios;
    * Setting up ingresses and TLS
              * Fully configure something like Nginx Ingress Controller or Traefik.
              * Create TLS Secrets within Kubernetes, and use them in your ingress controller.
    * Managing RBAC  (Don’t know enough about this one, but sounds like a good concept to include)
              * Creating new roles, etc

I’ll have a think and if anymore come to me, I’ll let you know.


Denny Zhang (Github . Blogger)
[1:19 AM]
:thumbsup:

Will update per your suggestions tomorrow, Aaron
** TODO k8s add DNS chanllenges
Gui [4:01 PM]
Getting familiar with the concepts like pod, service, RC, deployment, etc.


[4:02]
Try volume


[4:02]
DNS.


Denny Zhang (Github . Blogger)
[4:02 PM]
I’m trying to cover the volume via mysql scenarios


Gui [4:02 PM]
And other addons
1 reply Today at 4:03 PM View thread


Denny Zhang (Github . Blogger)
[4:02 PM]
For DNS, not sure whether I get your point


Gui [4:03 PM]
I haven't tried a lot myself.
1 reply Today at 4:03 PM View thread


[4:03]
Like every pod and service has an DNS name to talk to each other.


Denny Zhang (Github . Blogger) [4:04 PM]
Yes, that makes sense


[4:04]
For addons, do you have any recommended scenario?
** TODO k8s add challenge of addon
https://www.cncf.io

https://kubernetes.io/docs/concepts/cluster-administration/addons/
** TODO k8s networking models
** TODO k8s example: https://github.com/kubernetes/examples
** TODO Blog: Wordpress powered by k8s, docker swarm
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO [#A] absord: https://github.com/kubecamp/kubernetes_in_one_day
** TODO [#A] absord: https://github.com/kubecamp/kubernetes_in_2_days
** DONE kubectl config view
   CLOSED: [2017-12-31 Sun 10:40]
** DONE [#A] kubernetes persistent volume claim pending
  CLOSED: [2017-12-31 Sun 11:32]
https://github.com/openshift/origin/issues/7170

kubectl get pvc
kubectl get pv

#+BEGIN_EXAMPLE
ubuntu@k8s1:~$ kubectl describe pvc
Name:          ironic-gerbil-jenkins
Namespace:     default
StorageClass:
Status:        Pending
Volume:
Labels:        app=ironic-gerbil-jenkins
               chart=jenkins-0.10.2
               heritage=Tiller
               release=ironic-gerbil
Annotations:   <none>
Capacity:
Access Modes:
Events:
  Type    Reason         Age                 From                         Message
  ----    ------         ----                ----                         -------
  Normal  FailedBinding  37s (x261 over 2h)  persistentvolume-controller  no persistent volumes available for this claim and no storage class is set


Name:          my-mysql-mysql
Namespace:     default
StorageClass:
Status:        Pending
Volume:
Labels:        app=my-mysql-mysql
               chart=mysql-0.3.2
               heritage=Tiller
               release=my-mysql
Annotations:   <none>
Capacity:
Access Modes:
Events:
  Type    Reason         Age              From                         Message
  ----    ------         ----             ----                         -------
  Normal  FailedBinding  7s (x5 over 1m)  persistentvolume-controller  no persistent volumes available for this claim and no storage class is set
#+END_EXAMPLE
** DONE kubernetes start a container for testing: kubectl run -i --tty ubuntu --image=ubuntu:16.04 --restart=Never -- bash -il
   CLOSED: [2017-12-31 Sun 11:26]
** DONE [#A] ReplicaSet is the next-generation Replication Controller.
  CLOSED: [2017-12-04 Mon 11:26]
The only difference between a ReplicaSet and a Replication Controller right now is the selector support.

https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/

https://github.com/arun-gupta/oreilly-kubernetes-book/blob/master/ch01/wildfly-replicaset.yml
Next generation Replication Controller

Set-based selector requirement
- Expression: key, operator, value
- Operators: In, NotIn, Exists, DoesNotExist

▪Generally created with Deployment
▪Enables Horizontal Pod Autoscaling
** DONE k8s yaml API version: https://kubernetes.io/docs/reference/federation/extensions/v1beta1/definitions/
   CLOSED: [2017-12-03 Sun 12:50]
*** web page: extensions/v1beta1 Model Definitions | Kubernetes
https://kubernetes.io/docs/reference/federation/extensions/v1beta1/definitions/
**** webcontent                                                    :noexport:
#+begin_example
Location: https://kubernetes.io/docs/reference/federation/extensions/v1beta1/definitions/
  * Documentation
  * Blog
  * Partners
  * Community
  * Case Studies
  * v1.8
      + v1.8
      + v1.7
      + v1.6
      + v1.5
      + v1.4

Try Kubernetessubmit
submit
Get Started

Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for
Node.js.

Documentation

Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You
can even help contribute to the docs!

Community

If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend
community events, and watch video presentations from around the web.

Blog

Read the latest news for Kubernetes and the containers space in general, and get technical how-tos
hot off the presses.

Interested in hacking on the core Kubernetes code base?

View On Github

Explore the community

Twitter Github Slack Stack Overflow Mailing List Events Calendar

Reference Documentation

Design docs, concept definitions, and references for APIs and CLIs.

  * HOME
  * SETUP
  * CONCEPTS
  * TASKS
  * TUTORIALS
  * REFERENCE

[                    ]

Edit This Page

Top Level API Objects

  * v1beta1.Deployment

  * v1beta1.DeploymentList

  * v1beta1.DeploymentRollback

  * v1beta1.Scale

  * v1beta1.DaemonSetList

  * v1beta1.DaemonSet

  * v1beta1.Ingress

  * v1beta1.IngressList

  * v1beta1.ReplicaSet

  * v1beta1.ReplicaSetList

Definitions

v1beta1.DeploymentStatus

DeploymentStatus is the most recently observed status of the Deployment.

       Name                    Description             Required           Schema            Default
observedGeneration  The generation observed by the     false    integer (int64)
                    deployment controller.

                    Total number of non-terminated
replicas            pods targeted by this deployment   false    integer (int32)
                    (their labels match the selector).

                    Total number of non-terminated
updatedReplicas     pods targeted by this deployment   false    integer (int32)
                    that have the desired template
                    spec.

readyReplicas       Total number of ready pods         false    integer (int32)
                    targeted by this deployment.

                    Total number of available pods
availableReplicas   (ready for at least                false    integer (int32)
                    minReadySeconds) targeted by this
                    deployment.

                    Total number of unavailable pods
                    targeted by this deployment. This
                    is the total number of pods that
                    are still required for the
unavailableReplicas deployment to have 100% available  false    integer (int32)
                    capacity. They may either be pods
                    that are running but not yet
                    available or pods that still have
                    not been created.

                    Represents the latest available             v1beta1.DeploymentCondition
conditions          observations of a deployment’s     false    array
                    current state.

                    Count of hash collisions for the
                    Deployment. The Deployment
collisionCount      controller uses this field as a    false    integer (int32)
                    collision avoidance mechanism when
                    it needs to create the name for
                    the newest ReplicaSet.

v1.APIResourceList

APIResourceList is a list of APIResource, it is used to expose the name of the resources supported
in a specific group and version, and if the resource is namespaced.

    Name                                      Description                                   Required     Schema     Default
             Kind is a string value representing the REST resource this object represents.
kind         Servers may infer this from the endpoint the client submits requests to.       false    string
             Cannot be updated. In CamelCase. More info:
             https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

             APIVersion defines the versioned schema of this representation of an object.
apiVersion   Servers should convert recognized schemas to the latest internal value, and    false    string
             may reject unrecognized values. More info:
             https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

groupVersion groupVersion is the group and version this APIResourceList is for.             true     string

resources    resources contains the name of the resources and if they are namespaced.       true     v1.APIResource
                                                                                                     array

v1.Affinity

Affinity is a group of affinity scheduling rules.

     Name                         Description                   Required       Schema       Default
nodeAffinity    Describes node affinity scheduling rules for    false    v1.NodeAffinity
                the pod.

                Describes pod affinity scheduling rules (e.g.
podAffinity     co-locate this pod in the same node, zone, etc. false    v1.PodAffinity
                as some other pod(s)).

                Describes pod anti-affinity scheduling rules
podAntiAffinity (e.g. avoid putting this pod in the same node,  false    v1.PodAntiAffinity
                zone, etc. as some other pod(s)).

v1beta1.DaemonSetStatus

DaemonSetStatus represents the current status of a daemon set.

         Name                                      Description                              Required Schema  Default
                       The number of nodes that are running at least 1 daemon pod and are            integer
currentNumberScheduled supposed to run the daemon pod. More info:                           true     (int32)
                       https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/

                       The number of nodes that are running the daemon pod, but are not              integer
numberMisscheduled     supposed to run the daemon pod. More info:                           true     (int32)
                       https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/

                       The total number of nodes that should be running the daemon pod               integer
desiredNumberScheduled (including nodes correctly running the daemon pod). More info:       true     (int32)
                       https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/

numberReady            The number of nodes that should be running the daemon pod and have   true     integer
                       one or more of the daemon pod running and ready.                              (int32)

observedGeneration     The most recent generation observed by the daemon set controller.    false    integer
                                                                                                     (int64)

updatedNumberScheduled The total number of nodes that are running updated daemon pod        false    integer
                                                                                                     (int32)

                       The number of nodes that should be running the daemon pod and have            integer
numberAvailable        one or more of the daemon pod running and available (ready for at    false    (int32)
                       least spec.minReadySeconds)

                       The number of nodes that should be running the daemon pod and have            integer
numberUnavailable      none of the daemon pod running and available (ready for at least     false    (int32)
                       spec.minReadySeconds)

                       Count of hash collisions for the DaemonSet. The DaemonSet controller          integer
collisionCount         uses this field as a collision avoidance mechanism when it needs to  false    (int32)
                       create the name for the newest ControllerRevision.

v1.NodeSelectorTerm

A null or empty node selector term matches no objects.

      Name                    Description               Required           Schema           Default
                 Required. A list of node selector               v1.NodeSelectorRequirement
matchExpressions requirements. The requirements are     true     array
                 ANDed.

v1.Preconditions

Preconditions must be fulfilled before an operation (update, delete, etc.) is carried out.

Name        Description        Required  Schema   Default
uid  Specifies the target UID. false    types.UID

v1.ObjectFieldSelector

ObjectFieldSelector selects an APIVersioned field of an object.

   Name                              Description                            Required Schema Default
apiVersion Version of the schema the FieldPath is written in terms of,      false    string
           defaults to "v1".

fieldPath  Path of the field to select in the specified API version.        true     string

v1.SELinuxOptions

SELinuxOptions are the labels to be applied to the container

Name                          Description                         Required Schema Default
user  User is a SELinux user label that applies to the container. false    string

role  Role is a SELinux role label that applies to the container. false    string

type  Type is a SELinux type label that applies to the container. false    string

level Level is SELinux level label that applies to the container. false    string

v1beta1.IngressSpec

IngressSpec describes the Ingress the user wishes to exist.

 Name                       Description                     Required         Schema         Default
        A default backend capable of servicing requests
        that don’t match any rule. At least one of backend
backend or rules must be specified. This field is optional  false    v1beta1.IngressBackend
        to allow the loadbalancer controller or defaulting
        logic to specify a global default.

        TLS configuration. Currently the Ingress only
        supports a single TLS port, 443. If multiple
        members of this list specify different hosts, they           v1beta1.IngressTLS
tls     will be multiplexed on the same port according to   false    array
        the hostname specified through the SNI TLS
        extension, if the ingress controller fulfilling the
        ingress supports SNI.

        A list of host rules used to configure the Ingress.          v1beta1.IngressRule
rules   If unspecified, or no rule matches, all traffic is  false    array
        sent to the default backend.

v1.VolumeMount

VolumeMount describes a mounting of a Volume within a container.

      Name                      Description                Required         Schema          Default
name             This must match the Name of a Volume.     true     string

                 Mounted read-only if true, read-write
readOnly         otherwise (false or unspecified).         false    boolean                 false
                 Defaults to false.

                 Path within the container at which the
mountPath        volume should be mounted. Must not        true     string
                 contain :.

                 Path within the volume from which the
subPath          container’s volume should be mounted.     false    string
                 Defaults to "" (volume’s root).

                 mountPropagation determines how mounts
                 are propagated from the host to container
mountPropagation and the other way around. When not set,   false    v1.MountPropagationMode
                 MountPropagationHostToContainer is used.
                 This field is alpha in 1.8 and can be
                 reworked or removed in a future release.

v1.MountPropagationMode

v1.DownwardAPIProjection

Represents downward API info for projecting into a projected volume. Note that this is identical to
a downwardAPI volume source without the default mode.

Name                 Description                Required             Schema             Default
items Items is a list of DownwardAPIVolume file false    v1.DownwardAPIVolumeFile array

v1.LabelSelector

A label selector is a label query over a set of resources. The result of matchLabels and
matchExpressions are ANDed. An empty label selector matches all objects. A null label selector
matches no objects.

      Name                    Description              Required           Schema            Default
                 matchLabels is a map of {key,value}
                 pairs. A single {key,value} in the
                 matchLabels map is equivalent to an
matchLabels      element of matchExpressions, whose    false    object
                 key field is "key", the operator is
                 "In", and the values array contains
                 only "value". The requirements are
                 ANDed.

                 matchExpressions is a list of label            v1.LabelSelectorRequirement
matchExpressions selector requirements. The            false    array
                 requirements are ANDed.

v1beta1.IngressBackend

IngressBackend describes all endpoints for a given service and port.

   Name                      Description                  Required Schema Default
serviceName Specifies the name of the referenced service. true     string

servicePort Specifies the port of the referenced service. true     string

v1beta1.ReplicaSetList

ReplicaSetList is a collection of ReplicaSets.

   Name                                      Description                                   Required       Schema       Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to. Cannot false    string
           be updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and may false    string
           reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard list metadata. More info:                                              false    v1.ListMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

items      List of ReplicaSets. More info:                                                 true     v1beta1.ReplicaSet
           https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller          array

v1.CephFSVolumeSource

Represents a Ceph Filesystem mount that lasts the lifetime of a pod Cephfs volumes do not support
ownership management or SELinux relabeling.

   Name                                    Description                                  Required         Schema          Default
monitors   Required: Monitors is a collection of Ceph monitors More info:               true     string array
           https://releases.k8s.io/HEAD/examples/volumes/cephfs/README.md#how-to-use-it

path       Optional: Used as the mounted root, rather than the full Ceph tree, default  false    string
           is /

user       Optional: User is the rados user name, default is admin More info:           false    string
           https://releases.k8s.io/HEAD/examples/volumes/cephfs/README.md#how-to-use-it

           Optional: SecretFile is the path to key ring for User, default is /etc/ceph/
secretFile user.secret More info:                                                       false    string
           https://releases.k8s.io/HEAD/examples/volumes/cephfs/README.md#how-to-use-it

           Optional: SecretRef is reference to the authentication secret for User,
secretRef  default is empty. More info:                                                 false    v1.LocalObjectReference
           https://releases.k8s.io/HEAD/examples/volumes/cephfs/README.md#how-to-use-it

           Optional: Defaults to false (read/write). ReadOnly here will force the
readOnly   ReadOnly setting in VolumeMounts. More info:                                 false    boolean                 false
           https://releases.k8s.io/HEAD/examples/volumes/cephfs/README.md#how-to-use-it

v1beta1.IngressStatus

IngressStatus describe the current state of the Ingress.

    Name                       Description                   Required        Schema         Default
loadBalancer LoadBalancer contains the current status of the false    v1.LoadBalancerStatus
             load-balancer.

v1.DownwardAPIVolumeSource

DownwardAPIVolumeSource represents a volume containing downward API info. Downward API volumes
support ownership management and SELinux relabeling.

   Name                      Description                  Required          Schema          Default
items       Items is a list of downward API volume file   false    v1.DownwardAPIVolumeFile
                                                                   array

            Optional: mode bits to use on created files
            by default. Must be a value between 0 and
            0777. Defaults to 0644. Directories within
defaultMode the path are not affected by this setting.    false    integer (int32)
            This might be in conflict with other options
            that affect the file mode, like fsGroup, and
            the result can be other mode bits set.

v1beta1.ReplicaSetCondition

ReplicaSetCondition describes the state of a replica set at a certain point.

       Name                              Description                        Required Schema Default
type               Type of replica set condition.                           true     string

status             Status of the condition, one of True, False, Unknown.    true     string

lastTransitionTime The last time the condition transitioned from one status false    string
                   to another.

reason             The reason for the condition’s last transition.          false    string

message            A human readable message indicating details about the    false    string
                   transition.

v1.GCEPersistentDiskVolumeSource

Represents a Persistent Disk resource in Google Compute Engine.

A GCE PD must exist before mounting to a container. The disk must also be in the same GCE project
and zone as the kubelet. A GCE PD can only be mounted as read/write once or read-only many times.
GCE PDs support ownership management and SELinux relabeling.

  Name                                 Description                              Required Schema  Default
          Unique name of the PD resource in GCE. Used to identify the disk in
pdName    GCE. More info:                                                       true     string
          https://kubernetes.io/docs/concepts/storage/volumes#gcepersistentdisk

          Filesystem type of the volume that you want to mount. Tip: Ensure
          that the filesystem type is supported by the host operating system.
fsType    Examples: "ext4", "xfs", "ntfs". Implicitly inferred to be "ext4" if  false    string
          unspecified. More info:
          https://kubernetes.io/docs/concepts/storage/volumes#gcepersistentdisk

          The partition in the volume that you want to mount. If omitted, the
          default is to mount by volume name. Examples: For volume /dev/sda1,            integer
partition you specify the partition as "1". Similarly, the volume partition for false    (int32)
          /dev/sda is "0" (or you can leave the property empty). More info:
          https://kubernetes.io/docs/concepts/storage/volumes#gcepersistentdisk

          ReadOnly here will force the ReadOnly setting in VolumeMounts.
readOnly  Defaults to false. More info:                                         false    boolean false
          https://kubernetes.io/docs/concepts/storage/volumes#gcepersistentdisk

v1beta1.RollingUpdateDeployment

Spec to control the desired behavior of rolling update.

     Name                              Description                          Required Schema Default
               The maximum number of pods that can be unavailable during
               the update. Value can be an absolute number (ex: 5) or a
               percentage of desired pods (ex: 10%). Absolute number is
               calculated from percentage by rounding down. This can not be
               0 if MaxSurge is 0. By default, a fixed value of 1 is used.
maxUnavailable Example: when this is set to 30%, the old RC can be scaled   false    string
               down to 70% of desired pods immediately when the rolling
               update starts. Once new pods are ready, old RC can be scaled
               down further, followed by scaling up the new RC, ensuring
               that the total number of pods available at all times during
               the update is at least 70% of desired pods.

               The maximum number of pods that can be scheduled above the
               desired number of pods. Value can be an absolute number (ex:
               5) or a percentage of desired pods (ex: 10%). This can not
               be 0 if MaxUnavailable is 0. Absolute number is calculated
               from percentage by rounding up. By default, a value of 1 is
maxSurge       used. Example: when this is set to 30%, the new RC can be    false    string
               scaled up immediately when the rolling update starts, such
               that the total number of old and new pods do not exceed 130%
               of desired pods. Once old pods have been killed, new RC can
               be scaled up further, ensuring that total number of pods
               running at any time during the update is atmost 130% of
               desired pods.

v1beta1.HTTPIngressRuleValue

HTTPIngressRuleValue is a list of http selectors pointing to backends. In the example:
http://<host>/<path>?<searchpart> → backend where where parts of the url correspond to RFC 3986,
this resource will be used to match against everything after the last / and before the first ? or #
.

Name                    Description                    Required           Schema            Default
paths A collection of paths that map requests to       true     v1beta1.HTTPIngressPath
      backends.                                                 array

v1.ConfigMapVolumeSource

Adapts a ConfigMap into a volume.

The contents of the target ConfigMap’s Data field will be presented in a volume as files using the
keys in the Data field as the file names, unless the items element is populated with specific
mappings of keys to paths. ConfigMap volumes support ownership management and SELinux relabeling.

   Name                                      Description                                   Required    Schema    Default
name        Name of the referent. More info:                                               false    string
            https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

            If unspecified, each key-value pair in the Data field of the referenced
            ConfigMap will be projected into the volume as a file whose name is the key
            and content is the value. If specified, the listed keys will be projected into          v1.KeyToPath
items       the specified paths, and unlisted keys will not be present. If a key is        false    array
            specified which is not present in the ConfigMap, the volume setup will error
            unless it is marked optional. Paths must be relative and may not contain the
            .. path or start with ...

            Optional: mode bits to use on created files by default. Must be a value
defaultMode between 0 and 0777. Defaults to 0644. Directories within the path are not      false    integer
            affected by this setting. This might be in conflict with other options that             (int32)
            affect the file mode, like fsGroup, and the result can be other mode bits set.

optional    Specify whether the ConfigMap or it’s keys must be defined                     false    boolean      false

v1.GitRepoVolumeSource

Represents a volume that is populated with the contents of a git repository. Git repo volumes do
not support ownership management. Git repo volumes support SELinux relabeling.

   Name                              Description                            Required Schema Default
repository Repository URL                                                   true     string

revision   Commit hash for the specified revision.                          false    string

           Target directory name. Must not contain or start with ... If .
directory  is supplied, the volume directory will be the git repository.    false    string
           Otherwise, if specified, the volume will contain the git
           repository in the subdirectory with the given name.

v1.SecretEnvSource

SecretEnvSource selects a Secret to populate the environment variables with.

The contents of the target Secret’s Data field will represent the key-value pairs as environment
variables.

  Name                                    Description                                   Required Schema  Default
name     Name of the referent. More info:                                               false    string
         https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

optional Specify whether the Secret must be defined                                     false    boolean false

v1.PortworxVolumeSource

PortworxVolumeSource represents a Portworx volume resource.

  Name                              Description                            Required Schema  Default
volumeID VolumeID uniquely identifies a Portworx volume                    true     string

         FSType represents the filesystem type to mount Must be a
fsType   filesystem type supported by the host operating system. Ex.       false    string
         "ext4", "xfs". Implicitly inferred to be "ext4" if unspecified.

readOnly Defaults to false (read/write). ReadOnly here will force the      false    boolean false
         ReadOnly setting in VolumeMounts.

v1.Capabilities

Adds and removes POSIX capabilities from running containers.

Name     Description      Required       Schema        Default
add  Added capabilities   false    v1.Capability array

drop Removed capabilities false    v1.Capability array

v1.Initializer

Initializer is information about an initializer that has not yet completed.

Name                              Description                              Required Schema Default
name name of the process that is responsible for initializing this object. true     string

v1.LocalObjectReference

LocalObjectReference contains enough information to let you locate the referenced object inside the
same namespace.

Name                                  Description                                   Required Schema Default
name Name of the referent. More info:                                               false    string
     https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

v1.ProjectedVolumeSource

Represents a projected volume source

   Name                        Description                     Required       Schema        Default
sources     list of volume projections                         true     v1.VolumeProjection
                                                                        array

            Mode bits to use on created files by default. Must
            be a value between 0 and 0777. Directories within
defaultMode the path are not affected by this setting. This    false    integer (int32)
            might be in conflict with other options that
            affect the file mode, like fsGroup, and the result
            can be other mode bits set.

v1.ExecAction

ExecAction describes a "run in container" action.

 Name                  Description                             Required              Schema Default
        Command is the command line to execute     ', etc) won’t work. To use a
        inside the container, the working          shell, you need to explicitly
        directory for the command is root (/) in   call out to that shell. Exit             string
command the container’s filesystem. The command is status of 0 is treated as live/   false  array
        simply exec’d, it is not run inside a      healthy and non-zero is
        shell, so traditional shell instructions   unhealthy.
        ('

v1beta1.RollingUpdateDaemonSet

Spec to control the desired behavior of daemon set rolling update.

     Name                              Description                          Required Schema Default
               The maximum number of DaemonSet pods that can be unavailable
               during the update. Value can be an absolute number (ex: 5)
               or a percentage of total number of DaemonSet pods at the
               start of the update (ex: 10%). Absolute number is calculated
               from percentage by rounding up. This cannot be 0. Default
               value is 1. Example: when this is set to 30%, at most 30% of
maxUnavailable the total number of nodes that should be running the daemon  false    string
               pod (i.e. status.desiredNumberScheduled) can have their pods
               stopped for an update at any given time. The update starts
               by stopping at most 30% of those DaemonSet pods and then
               brings up new DaemonSet pods in their place. Once the new
               pods are available, it then proceeds onto other DaemonSet
               pods, thus ensuring that at least 70% of original number of
               DaemonSet pods are available at all times during the update.

v1.ObjectMeta

ObjectMeta is metadata that all persisted resources must have, which includes all objects users
must create.

           Name                                                         Description                                               Required      Schema       Default
                           Name must be unique within a namespace. Is required when creating resources, although some
name                       resources may allow a client to request the generation of an appropriate name automatically. Name      false    string
                           is primarily intended for creation idempotence and configuration definition. Cannot be updated.
                           More info: http://kubernetes.io/docs/user-guide/identifiers#names

                           GenerateName is an optional prefix, used by the server, to generate a unique name ONLY IF the Name
                           field has not been provided. If this field is used, the name returned to the client will be
                           different than the name passed. This value will also be combined with a unique suffix. The provided
                           value has the same validation rules as the Name field, and may be truncated by the length of the
                           suffix required to make the value unique on the server.

generateName               If this field is specified and the generated name exists, the server will NOT return a 409 -           false    string
                           instead, it will either return 201 Created or 500 with Reason ServerTimeout indicating a unique
                           name could not be found in the time allotted, and the client should retry (optionally after the
                           time indicated in the Retry-After header).

                           Applied only if Name is not specified. More info:
                           https://git.k8s.io/community/contributors/devel/api-conventions.md#idempotency

                           Namespace defines the space within each name must be unique. An empty namespace is equivalent to
                           the "default" namespace, but "default" is the canonical representation. Not all objects are
namespace                  required to be scoped to a namespace - the value of this field for those objects will be empty.        false    string

                           Must be a DNS_LABEL. Cannot be updated. More info: http://kubernetes.io/docs/user-guide/namespaces

selfLink                   SelfLink is a URL representing this object. Populated by the system. Read-only.                        false    string

                           UID is the unique in time and space value for this object. It is typically generated by the server
                           on successful creation of a resource and is not allowed to change on PUT operations.
uid                                                                                                                               false    string
                           Populated by the system. Read-only. More info:
                           http://kubernetes.io/docs/user-guide/identifiers#uids

                           An opaque value that represents the internal version of this object that can be used by clients to
                           determine when objects have changed. May be used for optimistic concurrency, change detection, and
                           the watch operation on a resource or set of resources. Clients must treat these values as opaque
resourceVersion            and passed unmodified back to the server. They may only be valid for a particular resource or set      false    string
                           of resources.

                           Populated by the system. Read-only. Value must be treated as opaque by clients and . More info:
                           https://git.k8s.io/community/contributors/devel/api-conventions.md#concurrency-control-and-consistency

generation                 A sequence number representing a specific generation of the desired state. Populated by the system.    false    integer (int64)
                           Read-only.

                           CreationTimestamp is a timestamp representing the server time when this object was created. It is
                           not guaranteed to be set in happens-before order across separate operations. Clients may not set
creationTimestamp          this value. It is represented in RFC3339 form and is in UTC.                                           false    string

                           Populated by the system. Read-only. Null for lists. More info:
                           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

                           DeletionTimestamp is RFC 3339 date and time at which this resource will be deleted. This field is
                           set by the server when a graceful deletion is requested by the user, and is not directly settable
                           by a client. The resource is expected to be deleted (no longer visible from resource lists, and not
                           reachable by name) after the time in this field. Once set, this value may not be unset or be set
                           further into the future, although it may be shortened or the resource may be deleted prior to this
                           time. For example, a user may request that a pod is deleted in 30 seconds. The Kubelet will react
deletionTimestamp          by sending a graceful termination signal to the containers in the pod. After that 30 seconds, the      false    string
                           Kubelet will send a hard termination signal (SIGKILL) to the container and after cleanup, remove
                           the pod from the API. In the presence of network partitions, this object may still exist after this
                           timestamp, until an administrator or automated process can determine the resource is fully
                           terminated. If not set, graceful deletion of the object has not been requested.

                           Populated by the system when a graceful deletion is requested. Read-only. More info:
                           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

deletionGracePeriodSeconds Number of seconds allowed for this object to gracefully terminate before it will be removed from       false    integer (int64)
                           the system. Only set when deletionTimestamp is also set. May only be shortened. Read-only.

                           Map of string keys and values that can be used to organize and categorize (scope and select)
labels                     objects. May match selectors of replication controllers and services. More info:                       false    object
                           http://kubernetes.io/docs/user-guide/labels

                           Annotations is an unstructured key value map stored with a resource that may be set by external
annotations                tools to store and retrieve arbitrary metadata. They are not queryable and should be preserved when    false    object
                           modifying objects. More info: http://kubernetes.io/docs/user-guide/annotations

                           List of objects depended by this object. If ALL objects in the list have been deleted, this object
ownerReferences            will be garbage collected. If this object is managed by a controller, then an entry in this list       false    v1.OwnerReference
                           will point to this controller, with the controller field set to true. There cannot be more than one             array
                           managing controller.

                           An initializer is a controller which enforces some system invariant at object creation time. This
                           field is a list of initializers that have not yet acted on this object. If nil or empty, this
                           object has been completely initialized. Otherwise, the object is considered uninitialized and is
                           hidden (in list/watch and get calls) from clients that haven’t explicitly asked to observe
initializers               uninitialized objects.                                                                                 false    v1.Initializers

                           When an object is created, the system will populate this list with the current set of initializers.
                           Only privileged users may set or modify this list. Once it is empty, it may not be modified further
                           by any user.

                           Must be empty before the object is deleted from the registry. Each entry is an identifier for the
finalizers                 responsible component that will remove the entry from the list. If the deletionTimestamp of the        false    string array
                           object is non-nil, entries in this list can only be removed.

                           The name of the cluster which the object belongs to. This is used to distinguish resources with
clusterName                same name and namespace in different clusters. This field is not set anywhere right now and            false    string
                           apiserver is going to ignore it if set in create or update request.

v1beta1.ReplicaSetSpec

ReplicaSetSpec is the specification of a ReplicaSet.

     Name                                                         Description                                                    Required       Schema       Default
                Replicas is the number of desired replicas. This is a pointer to distinguish between explicit zero
replicas        and unspecified. Defaults to 1. More info:                                                                       false    integer (int32)
                https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller/#what-is-a-replicationcontroller

                Minimum number of seconds for which a newly created pod should be ready without any of its
minReadySeconds container crashing, for it to be considered available. Defaults to 0 (pod will be considered                     false    integer (int32)
                available as soon as it is ready)

                Selector is a label query over pods that should match the replica count. If the selector is empty,
selector        it is defaulted to the labels present on the pod template. Label keys and values that must match in              false    v1.LabelSelector
                order to be controlled by this replica set. More info:
                https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors

                Template is the object that describes the pod that will be created if insufficient replicas are
template        detected. More info:                                                                                             false    v1.PodTemplateSpec
                https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller#pod-template

v1beta1.Deployment

DEPRECATED - This group version of Deployment is deprecated by apps/v1beta2/Deployment. See the
release notes for more information. Deployment enables declarative updates for Pods and
ReplicaSets.

   Name                                     Description                                   Required          Schema          Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to.       false    string
           Cannot be updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and    false    string
           may reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard object metadata.                                                      false    v1.ObjectMeta

spec       Specification of the desired behavior of the Deployment.                       false    v1beta1.DeploymentSpec

status     Most recently observed status of the Deployment.                               false    v1beta1.DeploymentStatus

v1beta1.DaemonSetSpec

DaemonSetSpec is the specification of a daemon set.

        Name                                                 Description                                          Required             Schema              Default
                     A label query over pods that are managed by the daemon set. Must match in order to be
selector             controlled. If empty, defaulted to labels on Pod template. More info:                        false    v1.LabelSelector
                     https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors

                     An object that describes the pod that will be created. The DaemonSet will create exactly one
template             copy of this pod on every node that matches the template’s node selector (or on every node   true     v1.PodTemplateSpec
                     if no node selector is specified). More info:
                     https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller#pod-template

updateStrategy       An update strategy to replace existing DaemonSet pods with new pods.                         false    v1beta1.DaemonSetUpdateStrategy

                     The minimum number of seconds for which a newly created DaemonSet pod should be ready
minReadySeconds      without any of its container crashing, for it to be considered available. Defaults to 0 (pod false    integer (int32)
                     will be considered available as soon as it is ready).

templateGeneration   DEPRECATED. A sequence number representing a specific generation of the template. Populated  false    integer (int64)
                     by the system. It can be set only during the creation.

revisionHistoryLimit The number of old history to retain to allow rollback. This is a pointer to distinguish      false    integer (int32)
                     between explicit zero and not specified. Defaults to 10.

types.UID

v1.AzureFileVolumeSource

AzureFile represents an Azure File Service mount on the host and bind mount to the pod.

   Name                              Description                           Required Schema  Default
secretName the name of secret that contains Azure Storage Account Name and true     string
           Key

shareName  Share Name                                                      true     string

readOnly   Defaults to false (read/write). ReadOnly here will force the    false    boolean false
           ReadOnly setting in VolumeMounts.

v1.ISCSIVolumeSource

Represents an ISCSI disk. ISCSI volumes can only be mounted as read/write once. ISCSI volumes
support ownership management and SELinux relabeling.

      Name                               Description                        Required         Schema          Default
                  iSCSI target portal. The portal is either an IP or
targetPortal      ip_addr:port if the port is other than default (typically true     string
                  TCP ports 860 and 3260).

iqn               Target iSCSI Qualified Name.                              true     string

lun               iSCSI target lun number.                                  true     integer (int32)

iscsiInterface    Optional: Defaults to default (tcp). iSCSI interface name false    string
                  that uses an iSCSI transport.

                  Filesystem type of the volume that you want to mount.
                  Tip: Ensure that the filesystem type is supported by the
fsType            host operating system. Examples: "ext4", "xfs", "ntfs".   false    string
                  Implicitly inferred to be "ext4" if unspecified. More
                  info:
                  https://kubernetes.io/docs/concepts/storage/volumes#iscsi

readOnly          ReadOnly here will force the ReadOnly setting in          false    boolean                 false
                  VolumeMounts. Defaults to false.

                  iSCSI target portal List. The portal is either an IP or
portals           ip_addr:port if the port is other than default (typically false    string array
                  TCP ports 860 and 3260).

chapAuthDiscovery whether support iSCSI Discovery CHAP authentication       false    boolean                 false

chapAuthSession   whether support iSCSI Session CHAP authentication         false    boolean                 false

secretRef         CHAP secret for iSCSI target and initiator authentication false    v1.LocalObjectReference

                  Custom iSCSI initiator name. If initiatorName is
initiatorName     specified with iscsiInterface simultaneously, new iSCSI   false    string
                  interface <target portal>:<volume name> will be created
                  for the connection.

v1beta1.IngressList

IngressList is a collection of Ingress.

   Name                                     Description                                   Required     Schema      Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to.       false    string
           Cannot be updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and    false    string
           may reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard object’s metadata. More info:                                         false    v1.ListMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

items      Items is the list of Ingress.                                                  true     v1beta1.Ingress
                                                                                                   array

v1.EmptyDirVolumeSource

Represents an empty directory for a pod. Empty directory volumes support ownership management and
SELinux relabeling.

  Name                               Description                            Required Schema Default
          What type of storage medium should back this directory. The
medium    default is "" which means to use the node’s default medium. Must  false    string
          be an empty string (default) or Memory. More info:
          https://kubernetes.io/docs/concepts/storage/volumes#emptydir

          Total amount of local storage required for this EmptyDir volume.
          The size limit is also applicable for memory medium. The maximum
          usage on memory medium EmptyDir would be the minimum value
sizeLimit between the SizeLimit specified here and the sum of memory limits false    string
          of all containers in a pod. The default is nil which means that
          the limit is undefined. More info:
          http://kubernetes.io/docs/user-guide/volumes#emptydir

v1beta1.ScaleSpec

describes the attributes of a scale subresource

  Name                      Description                     Required     Schema      Default
replicas desired number of instances for the scaled object. false    integer (int32)

v1.PodAffinityTerm

Defines a set of pods (namely those matching the labelSelector relative to the given namespace(s))
that this pod should be co-located (affinity) or not co-located (anti-affinity) with, where
co-located is defined as running on a node whose value of the label with key <topologyKey> tches
that of any node on which a pod of the set of pods is running

    Name                          Description                     Required      Schema      Default
labelSelector A label query over a set of resources, in this case false    v1.LabelSelector
              pods.

              namespaces specifies which namespaces the
namespaces    labelSelector applies to (matches against); null or false    string array
              empty list means "this pod’s namespace"

              This pod should be co-located (affinity) or not
              co-located (anti-affinity) with the pods matching
              the labelSelector in the specified namespaces,
              where co-located is defined as running on a node
              whose value of the label with key topologyKey
              matches that of any node on which any of the
topologyKey   selected pods is running. For                       false    string
              PreferredDuringScheduling pod anti-affinity, empty
              topologyKey is interpreted as "all topologies"
              ("all topologies" here means all the topologyKeys
              indicated by scheduler command-line argument
              --failure-domains); for affinity and for
              RequiredDuringScheduling pod anti-affinity, empty
              topologyKey is not allowed.

v1.EnvFromSource

EnvFromSource represents the source of a set of ConfigMaps

    Name                       Description                   Required        Schema         Default
prefix       An optional identifer to prepend to each key in false    string
             the ConfigMap. Must be a C_IDENTIFIER.

configMapRef The ConfigMap to select from                    false    v1.ConfigMapEnvSource

secretRef    The Secret to select from                       false    v1.SecretEnvSource

v1.PodAffinity

Pod affinity is a group of inter pod affinity scheduling rules.

                     Name                             Description        Required           Schema           Default
                                                If the affinity
                                                requirements specified
                                                by this field are not
                                                met at scheduling time,
                                                the pod will not be
                                                scheduled onto the node.
                                                If the affinity
                                                requirements specified
                                                by this field cease to
                                                be met at some point
requiredDuringSchedulingIgnoredDuringExecution  during pod execution     false    v1.PodAffinityTerm array
                                                (e.g. due to a pod label
                                                update), the system may
                                                or may not try to
                                                eventually evict the pod
                                                from its node. When
                                                there are multiple
                                                elements, the lists of
                                                nodes corresponding to
                                                each podAffinityTerm are
                                                intersected, i.e. all
                                                terms must be satisfied.

                                                The scheduler will
                                                prefer to schedule pods
                                                to nodes that satisfy
                                                the affinity expressions
                                                specified by this field,
                                                but it may choose a node
                                                that violates one or
                                                more of the expressions.
                                                The node that is most
                                                preferred is the one
                                                with the greatest sum of
                                                weights, i.e. for each
                                                node that meets all of
                                                the scheduling                    v1.WeightedPodAffinityTerm
preferredDuringSchedulingIgnoredDuringExecution requirements (resource   false    array
                                                request,
                                                requiredDuringScheduling
                                                affinity expressions,
                                                etc.), compute a sum by
                                                iterating through the
                                                elements of this field
                                                and adding "weight" to
                                                the sum if the node has
                                                pods which matches the
                                                corresponding
                                                podAffinityTerm; the
                                                node(s) with the highest
                                                sum are the most
                                                preferred.

v1.FlockerVolumeSource

Represents a Flocker volume mounted by the Flocker agent. One and only one of datasetName and
datasetUUID should be set. Flocker volumes do not support ownership management or SELinux
relabeling.

   Name                               Description                           Required Schema Default
datasetName Name of the dataset stored as metadata → name on the dataset    false    string
            for Flocker should be considered as deprecated

datasetUUID UUID of the dataset. This is unique identifier of a Flocker     false    string
            dataset

v1.PersistentVolumeClaimVolumeSource

PersistentVolumeClaimVolumeSource references the user’s PVC in the same namespace. This volume
finds the bound PV and mounts that volume for the pod. A PersistentVolumeClaimVolumeSource is,
essentially, a wrapper around another type of volume that is owned by someone else (the system).

  Name                                         Description                                      Required Schema  Default
          ClaimName is the name of a PersistentVolumeClaim in the same namespace as the pod
claimName using this volume. More info:                                                         true     string
          https://kubernetes.io/docs/concepts/storage/persistent-volumes#persistentvolumeclaims

readOnly  Will force the ReadOnly setting in VolumeMounts. Default false.                       false    boolean false

v1.ListMeta

ListMeta describes metadata that synthetic resources must have, including lists and various status
objects. A resource may have only one of {ObjectMeta, ListMeta}.

     Name                                                    Description                                               Required Schema Default
selfLink        selfLink is a URL representing this object. Populated by the system. Read-only.                        false    string

                String that identifies the server’s internal version of this object that can be used by clients to
resourceVersion determine when objects have changed. Value must be treated as opaque by clients and passed             false    string
                unmodified back to the server. Populated by the system. Read-only. More info:
                https://git.k8s.io/community/contributors/devel/api-conventions.md#concurrency-control-and-consistency

                continue may be set if the user set a limit on the number of items returned, and indicates that the
                server has more data available. The value is opaque and may be used to issue another request to the
continue        endpoint that served this list to retrieve the next set of available objects. Continuing a list may    false    string
                not be possible if the server configuration has changed or more than a few minutes have passed. The
                resourceVersion field returned when using this continue value will be identical to the value in the
                first response.

v1beta1.RollbackConfig

DEPRECATED.

  Name                           Description                          Required    Schema    Default
revision The revision to rollback to. If set to 0, rollback to the    false    integer
         last revision.                                                        (int64)

v1.SecretVolumeSource

Adapts a Secret into a volume.

The contents of the target Secret’s Data field will be presented in a volume as files using the
keys in the Data field as the file names. Secret volumes support ownership management and SELinux
relabeling.

   Name                            Description                         Required    Schema    Default
            Name of the secret in the pod’s namespace to use. More
secretName  info:                                                      false    string
            https://kubernetes.io/docs/concepts/storage/volumes#secret

            If unspecified, each key-value pair in the Data field of
            the referenced Secret will be projected into the volume as
            a file whose name is the key and content is the value. If
            specified, the listed keys will be projected into the               v1.KeyToPath
items       specified paths, and unlisted keys will not be present. If false    array
            a key is specified which is not present in the Secret, the
            volume setup will error unless it is marked optional.
            Paths must be relative and may not contain the .. path or
            start with ...

            Optional: mode bits to use on created files by default.
            Must be a value between 0 and 0777. Defaults to 0644.
defaultMode Directories within the path are not affected by this       false    integer
            setting. This might be in conflict with other options that          (int32)
            affect the file mode, like fsGroup, and the result can be
            other mode bits set.

optional    Specify whether the Secret or it’s keys must be defined    false    boolean      false

v1.FlexVolumeSource

FlexVolume represents a generic volume resource that is provisioned/attached using an exec based
plugin. This is an alpha feature and may change in future.

  Name                      Description                    Required         Schema          Default
driver    Driver is the name of the driver to use for this true     string
          volume.

          Filesystem type to mount. Must be a filesystem
fsType    type supported by the host operating system. Ex. false    string
          "ext4", "xfs", "ntfs". The default filesystem
          depends on FlexVolume script.

          Optional: SecretRef is reference to the secret
          object containing sensitive information to pass
secretRef to the plugin scripts. This may be empty if no   false    v1.LocalObjectReference
          secret object is specified. If the secret object
          contains more than one secret, all secrets are
          passed to the plugin scripts.

          Optional: Defaults to false (read/write).
readOnly  ReadOnly here will force the ReadOnly setting in false    boolean                 false
          VolumeMounts.

options   Optional: Extra command options if any.          false    object

v1.EnvVarSource

EnvVarSource represents a source for the value of an EnvVar.

      Name                     Description                Required          Schema          Default
                 Selects a field of the pod: supports
                 metadata.name, metadata.namespace,
fieldRef         metadata.labels, metadata.annotations,   false    v1.ObjectFieldSelector
                 spec.nodeName, spec.serviceAccountName,
                 status.hostIP, status.podIP.

                 Selects a resource of the container:
                 only resources limits and requests
                 (limits.cpu, limits.memory,
resourceFieldRef limits.ephemeral-storage, requests.cpu,  false    v1.ResourceFieldSelector
                 requests.memory and
                 requests.ephemeral-storage) are
                 currently supported.

configMapKeyRef  Selects a key of a ConfigMap.            false    v1.ConfigMapKeySelector

secretKeyRef     Selects a key of a secret in the pod’s   false    v1.SecretKeySelector
                 namespace

v1.LoadBalancerIngress

LoadBalancerIngress represents the status of a load-balancer ingress point: traffic intended for
the service should be sent to an ingress point.

  Name                              Description                             Required Schema Default
ip       IP is set for load-balancer ingress points that are IP based       false    string
         (typically GCE or OpenStack load-balancers)

hostname Hostname is set for load-balancer ingress points that are DNS      false    string
         based (typically AWS load-balancers)

v1.AzureDiskVolumeSource

AzureDisk represents an Azure Data Disk mount on the host and bind mount to the pod.

   Name                    Description                 Required           Schema            Default
diskName    The Name of the data disk in the blob      true     string
            storage

diskURI     The URI the data disk in the blob storage  true     string

cachingMode Host Caching mode: None, Read Only, Read   false    v1.AzureDataDiskCachingMode
            Write.

            Filesystem type to mount. Must be a
            filesystem type supported by the host
fsType      operating system. Ex. "ext4", "xfs",       false    string
            "ntfs". Implicitly inferred to be "ext4"
            if unspecified.

            Defaults to false (read/write). ReadOnly
readOnly    here will force the ReadOnly setting in    false    boolean                     false
            VolumeMounts.

            Expected values Shared: mulitple blob
            disks per storage account Dedicated:
kind        single blob disk per storage account       false    v1.AzureDataDiskKind
            Managed: azure managed data disk (only in
            managed availability set). defaults to
            shared

v1.KeyToPath

Maps a string key to a path within a volume.

Name                              Description                              Required Schema  Default
key  The key to project.                                                   true     string

     The relative path of the file to map the key to. May not be an
path absolute path. May not contain the path element ... May not start     true     string
     with the string ...

     Optional: mode bits to use on this file, must be a value between 0
mode and 0777. If not specified, the volume defaultMode will be used. This false    integer
     might be in conflict with other options that affect the file mode,             (int32)
     like fsGroup, and the result can be other mode bits set.

v1beta1.DaemonSetUpdateStrategy

    Name                   Description              Required             Schema             Default
              Type of daemon set update. Can be
type          "RollingUpdate" or "OnDelete".        false    string
              Default is OnDelete.

rollingUpdate Rolling update config params. Present false    v1beta1.RollingUpdateDaemonSet
              only if type = "RollingUpdate".

v1.VsphereVirtualDiskVolumeSource

Represents a vSphere volume resource.

      Name                               Description                        Required Schema Default
volumePath        Path that identifies vSphere volume vmdk                  true     string

                  Filesystem type to mount. Must be a filesystem type
fsType            supported by the host operating system. Ex. "ext4",       false    string
                  "xfs", "ntfs". Implicitly inferred to be "ext4" if
                  unspecified.

storagePolicyName Storage Policy Based Management (SPBM) profile name.      false    string

storagePolicyID   Storage Policy Based Management (SPBM) profile ID         false    string
                  associated with the StoragePolicyName.

v1.DeleteOptions

DeleteOptions may be provided when deleting an API object.

       Name                                         Description                                   Required         Schema         Default
                   Kind is a string value representing the REST resource this object represents.
kind               Servers may infer this from the endpoint the client submits requests to.       false    string
                   Cannot be updated. In CamelCase. More info:
                   https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

                   APIVersion defines the versioned schema of this representation of an object.
apiVersion         Servers should convert recognized schemas to the latest internal value, and    false    string
                   may reject unrecognized values. More info:
                   https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

                   The duration in seconds before the object should be deleted. Value must be
                   non-negative integer. The value zero indicates delete immediately. If this
gracePeriodSeconds value is nil, the default grace period for the specified type will be used.    false    integer (int64)
                   Defaults to a per object value if not specified. zero means delete
                   immediately.

preconditions      Must be fulfilled before a deletion is carried out. If not possible, a 409     false    v1.Preconditions
                   Conflict status will be returned.

                   Deprecated: please use the PropagationPolicy, this field will be deprecated in
orphanDependents   1.7. Should the dependent objects be orphaned. If true/false, the "orphan"     false    boolean                false
                   finalizer will be added to/removed from the object’s finalizers list. Either
                   this field or PropagationPolicy may be set, but not both.

                   Whether and how garbage collection will be performed. Either this field or
propagationPolicy  OrphanDependents may be set, but not both. The default policy is decided by    false    v1.DeletionPropagation
                   the existing finalizer set in the metadata.finalizers and the
                   resource-specific default policy.

v1beta1.DaemonSetList

DaemonSetList is a collection of daemon sets.

   Name                                     Description                                   Required      Schema       Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to.       false    string
           Cannot be updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and    false    string
           may reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard list metadata. More info:                                             false    v1.ListMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

items      A list of daemon sets.                                                         true     v1beta1.DaemonSet
                                                                                                   array

v1.Volume

Volume represents a named volume in a pod that may be accessed by any container in the pod.

        Name                                               Description                                      Required                Schema                Default
name                  Volume’s name. Must be a DNS_LABEL and unique within the pod. More info:              true     string
                      https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

                      HostPath represents a pre-existing file or directory on the host machine that is
hostPath              directly exposed to the container. This is generally used for system agents or other  false    v1.HostPathVolumeSource
                      privileged things that are allowed to see the host machine. Most containers will NOT
                      need this. More info: https://kubernetes.io/docs/concepts/storage/volumes#hostpath

emptyDir              EmptyDir represents a temporary directory that shares a pod’s lifetime. More info:    false    v1.EmptyDirVolumeSource
                      https://kubernetes.io/docs/concepts/storage/volumes#emptydir

                      GCEPersistentDisk represents a GCE Disk resource that is attached to a kubelet’s host
gcePersistentDisk     machine and then exposed to the pod. More info:                                       false    v1.GCEPersistentDiskVolumeSource
                      https://kubernetes.io/docs/concepts/storage/volumes#gcepersistentdisk

                      AWSElasticBlockStore represents an AWS Disk resource that is attached to a kubelet’s
awsElasticBlockStore  host machine and then exposed to the pod. More info:                                  false    v1.AWSElasticBlockStoreVolumeSource
                      https://kubernetes.io/docs/concepts/storage/volumes#awselasticblockstore

gitRepo               GitRepo represents a git repository at a particular revision.                         false    v1.GitRepoVolumeSource

secret                Secret represents a secret that should populate this volume. More info:               false    v1.SecretVolumeSource
                      https://kubernetes.io/docs/concepts/storage/volumes#secret

nfs                   NFS represents an NFS mount on the host that shares a pod’s lifetime More info:       false    v1.NFSVolumeSource
                      https://kubernetes.io/docs/concepts/storage/volumes#nfs

                      ISCSI represents an ISCSI Disk resource that is attached to a kubelet’s host machine
iscsi                 and then exposed to the pod. More info:                                               false    v1.ISCSIVolumeSource
                      https://releases.k8s.io/HEAD/examples/volumes/iscsi/README.md

glusterfs             Glusterfs represents a Glusterfs mount on the host that shares a pod’s lifetime. More false    v1.GlusterfsVolumeSource
                      info: https://releases.k8s.io/HEAD/examples/volumes/glusterfs/README.md

                      PersistentVolumeClaimVolumeSource represents a reference to a PersistentVolumeClaim
persistentVolumeClaim in the same namespace. More info:                                                     false    v1.PersistentVolumeClaimVolumeSource
                      https://kubernetes.io/docs/concepts/storage/persistent-volumes#persistentvolumeclaims

rbd                   RBD represents a Rados Block Device mount on the host that shares a pod’s lifetime.   false    v1.RBDVolumeSource
                      More info: https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md

flexVolume            FlexVolume represents a generic volume resource that is provisioned/attached using an false    v1.FlexVolumeSource
                      exec based plugin. This is an alpha feature and may change in future.

cinder                Cinder represents a cinder volume attached and mounted on kubelets host machine More  false    v1.CinderVolumeSource
                      info: https://releases.k8s.io/HEAD/examples/mysql-cinder-pd/README.md

cephfs                CephFS represents a Ceph FS mount on the host that shares a pod’s lifetime            false    v1.CephFSVolumeSource

flocker               Flocker represents a Flocker volume attached to a kubelet’s host machine. This        false    v1.FlockerVolumeSource
                      depends on the Flocker control service being running

downwardAPI           DownwardAPI represents downward API about the pod that should populate this volume    false    v1.DownwardAPIVolumeSource

fc                    FC represents a Fibre Channel resource that is attached to a kubelet’s host machine   false    v1.FCVolumeSource
                      and then exposed to the pod.

azureFile             AzureFile represents an Azure File Service mount on the host and bind mount to the    false    v1.AzureFileVolumeSource
                      pod.

configMap             ConfigMap represents a configMap that should populate this volume                     false    v1.ConfigMapVolumeSource

vsphereVolume         VsphereVolume represents a vSphere volume attached and mounted on kubelets host       false    v1.VsphereVirtualDiskVolumeSource
                      machine

quobyte               Quobyte represents a Quobyte mount on the host that shares a pod’s lifetime           false    v1.QuobyteVolumeSource

azureDisk             AzureDisk represents an Azure Data Disk mount on the host and bind mount to the pod.  false    v1.AzureDiskVolumeSource

photonPersistentDisk  PhotonPersistentDisk represents a PhotonController persistent disk attached and       false    v1.PhotonPersistentDiskVolumeSource
                      mounted on kubelets host machine

projected             Items for all in one resources secrets, configmaps, and downward API                  false    v1.ProjectedVolumeSource

portworxVolume        PortworxVolume represents a portworx volume attached and mounted on kubelets host     false    v1.PortworxVolumeSource
                      machine

scaleIO               ScaleIO represents a ScaleIO persistent volume attached and mounted on Kubernetes     false    v1.ScaleIOVolumeSource
                      nodes.

storageos             StorageOS represents a StorageOS volume attached and mounted on Kubernetes nodes.     false    v1.StorageOSVolumeSource

v1.ResourceFieldSelector

ResourceFieldSelector represents container resources (cpu, memory) and their output format

    Name                               Description                          Required Schema Default
containerName Container name: required for volumes, optional for env vars   false    string

resource      Required: resource to select                                  true     string

divisor       Specifies the output format of the exposed resources,         false    string
              defaults to "1"

v1.VolumeProjection

Projection that may be projected along with other supported volume types

   Name                      Description                  Required          Schema          Default
secret      information about the secret data to project  false    v1.SecretProjection

downwardAPI information about the downwardAPI data to     false    v1.DownwardAPIProjection
            project

configMap   information about the configMap data to       false    v1.ConfigMapProjection
            project

v1.Probe

Probe describes a health check to be performed against a container to determine whether it is alive
or ready to receive traffic.

       Name                                            Description                                    Required       Schema       Default
exec                One and only one of the following should be specified. Exec specifies the action  false    v1.ExecAction
                    to take.

httpGet             HTTPGet specifies the http request to perform.                                    false    v1.HTTPGetAction

tcpSocket           TCPSocket specifies an action involving a TCP port. TCP hooks not yet supported   false    v1.TCPSocketAction

                    Number of seconds after the container has started before liveness probes are
initialDelaySeconds initiated. More info:                                                             false    integer (int32)
                    https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle#container-probes

                    Number of seconds after which the probe times out. Defaults to 1 second. Minimum
timeoutSeconds      value is 1. More info:                                                            false    integer (int32)
                    https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle#container-probes

periodSeconds       How often (in seconds) to perform the probe. Default to 10 seconds. Minimum value false    integer (int32)
                    is 1.

successThreshold    Minimum consecutive successes for the probe to be considered successful after     false    integer (int32)
                    having failed. Defaults to 1. Must be 1 for liveness. Minimum value is 1.

failureThreshold    Minimum consecutive failures for the probe to be considered failed after having   false    integer (int32)
                    succeeded. Defaults to 3. Minimum value is 1.

v1.WeightedPodAffinityTerm

The weights of all of the matched WeightedPodAffinityTerm fields are added per-node to find the
most preferred node(s)

     Name                         Description                   Required       Schema       Default
                weight associated with matching the
weight          corresponding podAffinityTerm, in the range     true     integer (int32)
                1-100.

podAffinityTerm Required. A pod affinity term, associated with  true     v1.PodAffinityTerm
                the corresponding weight.

v1beta1.DeploymentSpec

DeploymentSpec is the specification of the desired behavior of the Deployment.

         Name                     Description           Required           Schema           Default
                        Number of desired pods. This is
replicas                a pointer to distinguish        false    integer (int32)
                        between explicit zero and not
                        specified. Defaults to 1.

                        Label selector for pods.
                        Existing ReplicaSets whose pods
selector                are selected by this will be    false    v1.LabelSelector
                        the ones affected by this
                        deployment.

template                Template describes the pods     true     v1.PodTemplateSpec
                        that will be created.

                        The deployment strategy to use
strategy                to replace existing pods with   false    v1beta1.DeploymentStrategy
                        new ones.

                        Minimum number of seconds for
                        which a newly created pod
                        should be ready without any of
minReadySeconds         its container crashing, for it  false    integer (int32)
                        to be considered available.
                        Defaults to 0 (pod will be
                        considered available as soon as
                        it is ready)

                        The number of old ReplicaSets
                        to retain to allow rollback.
revisionHistoryLimit    This is a pointer to            false    integer (int32)
                        distinguish between explicit
                        zero and not specified.

                        Indicates that the deployment
paused                  is paused and will not be       false    boolean                    false
                        processed by the deployment
                        controller.

                        DEPRECATED. The config this
rollbackTo              deployment is rolling back to.  false    v1beta1.RollbackConfig
                        Will be cleared after rollback
                        is done.

                        The maximum time in seconds for
                        a deployment to make progress
                        before it is considered to be
                        failed. The deployment
                        controller will continue to
                        process failed deployments and
progressDeadlineSeconds a condition with a              false    integer (int32)
                        ProgressDeadlineExceeded reason
                        will be surfaced in the
                        deployment status. Note that
                        progress will not be estimated
                        during the time a deployment is
                        paused. This is not set by
                        default.

v1.SecretKeySelector

SecretKeySelector selects a key of a Secret.

  Name                                    Description                                   Required Schema  Default
name     Name of the referent. More info:                                               false    string
         https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

key      The key of the secret to select from. Must be a valid secret key.              true     string

optional Specify whether the Secret or it’s key must be defined                         false    boolean false

v1.Capability

v1.DownwardAPIVolumeFile

DownwardAPIVolumeFile represents information to create the file containing the pod field

      Name                     Description                Required          Schema          Default
                 Required: Path is the relative path name
                 of the file to be created. Must not be
path             absolute or contain the .. path. Must be true     string
                 utf-8 encoded. The first item of the
                 relative path must not start with ..

                 Required: Selects a field of the pod:
fieldRef         only annotations, labels, name and       false    v1.ObjectFieldSelector
                 namespace are supported.

                 Selects a resource of the container:
                 only resources limits and requests
resourceFieldRef (limits.cpu, limits.memory, requests.cpu false    v1.ResourceFieldSelector
                 and requests.memory) are currently
                 supported.

                 Optional: mode bits to use on this file,
                 must be a value between 0 and 0777. If
                 not specified, the volume defaultMode
mode             will be used. This might be in conflict  false    integer (int32)
                 with other options that affect the file
                 mode, like fsGroup, and the result can
                 be other mode bits set.

v1.PodSpec

PodSpec is a description of a pod.

            Name                                                     Description                                         Required         Schema          Default
volumes                       List of volumes that can be mounted by containers belonging to the pod. More info:         false    v1.Volume array
                              https://kubernetes.io/docs/concepts/storage/volumes

                              List of initialization containers belonging to the pod. Init containers are executed in
                              order prior to containers being started. If any init container fails, the pod is
                              considered to have failed and is handled according to its restartPolicy. The name for an
                              init container or normal container must be unique among all containers. Init containers
initContainers                may not have Lifecycle actions, Readiness probes, or Liveness probes. The                  false    v1.Container array
                              resourceRequirements of an init container are taken into account during scheduling by
                              finding the highest request/limit for each resource type, and then using the max of of
                              that value or the sum of the normal containers. Limits are applied to init containers in a
                              similar fashion. Init containers cannot currently be added or removed. Cannot be updated.
                              More info: https://kubernetes.io/docs/concepts/workloads/pods/init-containers/

containers                    List of containers belonging to the pod. Containers cannot currently be added or removed.  true     v1.Container array
                              There must be at least one container in a Pod. Cannot be updated.

                              Restart policy for all containers within the pod. One of Always, OnFailure, Never. Default
restartPolicy                 to Always. More info:                                                                      false    string
                              https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy

                              Optional duration in seconds the pod needs to terminate gracefully. May be decreased in
                              delete request. Value must be non-negative integer. The value zero indicates delete
                              immediately. If this value is nil, the default grace period will be used instead. The
terminationGracePeriodSeconds grace period is the duration in seconds after the processes running in the pod are sent a  false    integer (int64)
                              termination signal and the time when the processes are forcibly halted with a kill signal.
                              Set this value longer than the expected cleanup time for your process. Defaults to 30
                              seconds.

                              Optional duration in seconds the pod may be active on the node relative to StartTime
activeDeadlineSeconds         before the system will actively try to mark it failed and kill associated containers.      false    integer (int64)
                              Value must be a positive integer.

                              Set DNS policy for containers within the pod. One of ClusterFirstWithHostNet, ClusterFirst
dnsPolicy                     or Default. Defaults to "ClusterFirst". To have DNS options set along with hostNetwork,    false    string
                              you have to specify DNS policy explicitly to ClusterFirstWithHostNet.

                              NodeSelector is a selector which must be true for the pod to fit on a node. Selector which
nodeSelector                  must match a node’s labels for the pod to be scheduled on that node. More info:            false    object
                              https://kubernetes.io/docs/concepts/configuration/assign-pod-node/

serviceAccountName            ServiceAccountName is the name of the ServiceAccount to use to run this pod. More info:    false    string
                              https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/

serviceAccount                DeprecatedServiceAccount is a depreciated alias for ServiceAccountName. Deprecated: Use    false    string
                              serviceAccountName instead.

automountServiceAccountToken  AutomountServiceAccountToken indicates whether a service account token should be           false    boolean                 false
                              automatically mounted.

                              NodeName is a request to schedule this pod onto a specific node. If it is non-empty, the
nodeName                      scheduler simply schedules this pod onto that node, assuming that it fits resource         false    string
                              requirements.

hostNetwork                   Host networking requested for this pod. Use the host’s network namespace. If this option   false    boolean                 false
                              is set, the ports that will be used must be specified. Default to false.

hostPID                       Use the host’s pid namespace. Optional: Default to false.                                  false    boolean                 false

hostIPC                       Use the host’s ipc namespace. Optional: Default to false.                                  false    boolean                 false

securityContext               SecurityContext holds pod-level security attributes and common container settings.         false    v1.PodSecurityContext
                              Optional: Defaults to empty. See type description for default values of each field.

                              ImagePullSecrets is an optional list of references to secrets in the same namespace to use
                              for pulling any of the images used by this PodSpec. If specified, these secrets will be             v1.LocalObjectReference
imagePullSecrets              passed to individual puller implementations for them to use. For example, in the case of   false    array
                              docker, only DockerConfig type secrets are honored. More info:
                              https://kubernetes.io/docs/concepts/containers/images#specifying-imagepullsecrets-on-a-pod

hostname                      Specifies the hostname of the Pod If not specified, the pod’s hostname will be set to a    false    string
                              system-defined value.

                              If specified, the fully qualified Pod hostname will be "<hostname>.<subdomain>.<pod
subdomain                     namespace>.svc.<cluster domain>". If not specified, the pod will not have a domainname at  false    string
                              all.

affinity                      If specified, the pod’s scheduling constraints                                             false    v1.Affinity

schedulerName                 If specified, the pod will be dispatched by specified scheduler. If not specified, the pod false    string
                              will be dispatched by default scheduler.

tolerations                   If specified, the pod’s tolerations.                                                       false    v1.Toleration array

hostAliases                   HostAliases is an optional list of hosts and IPs that will be injected into the pod’s      false    v1.HostAlias array
                              hosts file if specified. This is only valid for non-hostNetwork pods.

                              If specified, indicates the pod’s priority. "SYSTEM" is a special keyword which indicates
priorityClassName             the highest priority. Any other name must be defined by creating a PriorityClass object    false    string
                              with that name. If not specified, the pod priority will be default or zero if there is no
                              default.

                              The priority value. Various system components use this field to find the priority of the
priority                      pod. When Priority Admission Controller is enabled, it prevents users from setting this    false    integer (int32)
                              field. The admission controller populates this field from PriorityClassName. The higher
                              the value, the higher the priority.

v1.ContainerPort

ContainerPort represents a network port in a single container.

    Name                              Description                          Required Schema  Default
              If specified, this must be an IANA_SVC_NAME and unique
name          within the pod. Each named port in a pod must have a unique  false    string
              name. Name for the port that can be referred to by services.

              Number of port to expose on the host. If specified, this
hostPort      must be a valid port number, 0 < x < 65536. If HostNetwork   false    integer
              is specified, this must match ContainerPort. Most containers          (int32)
              do not need this.

containerPort Number of port to expose on the pod’s IP address. This must  true     integer
              be a valid port number, 0 < x < 65536.                                (int32)

protocol      Protocol for port. Must be UDP or TCP. Defaults to "TCP".    false    string

hostIP        What host IP to bind the external port to.                   false    string

v1.Lifecycle

Lifecycle describes actions that the management system should take in response to container
lifecycle events. For the PostStart and PreStop lifecycle handlers, management of the container
blocks until the action is complete, unless the container process fails, in which case the handler
is aborted.

  Name                                           Description                                        Required   Schema   Default
          PostStart is called immediately after a container is created. If the handler fails, the
postStart container is terminated and restarted according to its restart policy. Other management   false    v1.Handler
          of the container blocks until the hook completes. More info:
          https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/#container-hooks

          PreStop is called immediately before a container is terminated. The container is
          terminated after the handler completes. The reason for termination is passed to the
preStop   handler. Regardless of the outcome of the handler, the container is eventually            false    v1.Handler
          terminated. Other management of the container blocks until the hook completes. More info:
          https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/#container-hooks

v1.GlusterfsVolumeSource

Represents a Glusterfs mount that lasts the lifetime of a pod. Glusterfs volumes do not support
ownership management or SELinux relabeling.

  Name                                     Description                                   Required Schema  Default
endpoints EndpointsName is the endpoint name that details Glusterfs topology. More info: true     string
          https://releases.k8s.io/HEAD/examples/volumes/glusterfs/README.md#create-a-pod

path      Path is the Glusterfs volume path. More info:                                  true     string
          https://releases.k8s.io/HEAD/examples/volumes/glusterfs/README.md#create-a-pod

          ReadOnly here will force the Glusterfs volume to be mounted with read-only
readOnly  permissions. Defaults to false. More info:                                     false    boolean false
          https://releases.k8s.io/HEAD/examples/volumes/glusterfs/README.md#create-a-pod

v1.Handler

Handler defines a specific action that should be taken

  Name                         Description                      Required       Schema       Default
exec      One and only one of the following should be           false    v1.ExecAction
          specified. Exec specifies the action to take.

httpGet   HTTPGet specifies the http request to perform.        false    v1.HTTPGetAction

tcpSocket TCPSocket specifies an action involving a TCP port.   false    v1.TCPSocketAction
          TCP hooks not yet supported

v1.Toleration

The pod this Toleration is attached to tolerates any taint that matches the triple
<key,value,effect> using the matching operator <operator>.

      Name                              Description                        Required Schema  Default
                  Key is the taint key that the toleration applies to.
key               Empty means match all taint keys. If the key is empty,   false    string
                  operator must be Exists; this combination means to match
                  all values and all keys.

                  Operator represents a key’s relationship to the value.
operator          Valid operators are Exists and Equal. Defaults to Equal. false    string
                  Exists is equivalent to wildcard for value, so that a
                  pod can tolerate all taints of a particular category.

                  Value is the taint value the toleration matches to. If
value             the operator is Exists, the value should be empty,       false    string
                  otherwise just a regular string.

                  Effect indicates the taint effect to match. Empty means
effect            match all taint effects. When specified, allowed values  false    string
                  are NoSchedule, PreferNoSchedule and NoExecute.

                  TolerationSeconds represents the period of time the
                  toleration (which must be of effect NoExecute, otherwise
tolerationSeconds this field is ignored) tolerates the taint. By default,  false    integer
                  it is not set, which means tolerate the taint forever             (int64)
                  (do not evict). Zero and negative values will be treated
                  as 0 (evict immediately) by the system.

v1beta1.IngressTLS

IngressTLS describes the transport layer security associated with an Ingress.

   Name                              Description                            Required Schema Default
           Hosts are a list of hosts included in the TLS certificate. The
hosts      values in this list must match the name/s used in the tlsSecret. false    string
           Defaults to the wildcard host setting for the loadbalancer                array
           controller fulfilling this Ingress, if left unspecified.

           SecretName is the name of the secret used to terminate SSL
           traffic on 443. Field is left optional to allow SSL routing
secretName based on SNI hostname alone. If the SNI host in a listener       false    string
           conflicts with the "Host" header field used by an IngressRule,
           the SNI host is used for termination and value of the Host
           header is used for routing.

v1.StatusCause

StatusCause provides more information about an api.Status failure, including cases when multiple
errors are encountered.

 Name                               Description                             Required Schema Default
reason  A machine-readable description of the cause of the error. If this   false    string
        value is empty there is no information available.

message A human-readable description of the cause of the error. This field  false    string
        may be presented as-is to a reader.

        The field of the resource that has caused this error, as named by
        its JSON serialization. May include dot and postfix notation for
        nested attributes. Arrays are zero-indexed. Fields may appear more
        than once in an array of causes due to fields having multiple
field   errors. Optional.                                                   false    string

        Examples:
        "name" - the field "name" on the current resource
        "items[0].name" - the field "name" on the first array entry in
        "items"

v1beta1.Scale

represents a scaling request for a resource.

   Name                                       Description                                     Required       Schema        Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to. Cannot be false    string
           updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and may    false    string
           reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard object metadata; More info:                                               false    v1.ObjectMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata.

           defines the behavior of the scale. More info:
spec       https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status false    v1beta1.ScaleSpec
           .

           current status of the scale. More info:
status     https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status false    v1beta1.ScaleStatus
           . Read-only.

v1.RBDVolumeSource

Represents a Rados Block Device mount that lasts the lifetime of a pod. RBD volumes support
ownership management and SELinux relabeling.

  Name                                   Description                                Required         Schema          Default
monitors  A collection of Ceph monitors. More info:                                 true     string array
          https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md#how-to-use-it

image     The rados image name. More info:                                          true     string
          https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md#how-to-use-it

          Filesystem type of the volume that you want to mount. Tip: Ensure that
fsType    the filesystem type is supported by the host operating system. Examples:  false    string
          "ext4", "xfs", "ntfs". Implicitly inferred to be "ext4" if unspecified.
          More info: https://kubernetes.io/docs/concepts/storage/volumes#rbd

pool      The rados pool name. Default is rbd. More info:                           false    string
          https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md#how-to-use-it

user      The rados user name. Default is admin. More info:                         false    string
          https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md#how-to-use-it

          Keyring is the path to key ring for RBDUser. Default is /etc/ceph/
keyring   keyring. More info:                                                       false    string
          https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md#how-to-use-it

          SecretRef is name of the authentication secret for RBDUser. If provided
secretRef overrides keyring. Default is nil. More info:                             false    v1.LocalObjectReference
          https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md#how-to-use-it

          ReadOnly here will force the ReadOnly setting in VolumeMounts. Defaults
readOnly  to false. More info:                                                      false    boolean                 false
          https://releases.k8s.io/HEAD/examples/volumes/rbd/README.md#how-to-use-it

v1.ConfigMapProjection

Adapts a ConfigMap into a projected volume.

The contents of the target ConfigMap’s Data field will be presented in a projected volume as files
using the keys in the Data field as the file names, unless the items element is populated with
specific mappings of keys to paths. Note that this is identical to a configmap volume source
without the default mode.

  Name                                    Description                                   Required    Schema    Default
name     Name of the referent. More info:                                               false    string
         https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

         If unspecified, each key-value pair in the Data field of the referenced
         ConfigMap will be projected into the volume as a file whose name is the key
         and content is the value. If specified, the listed keys will be projected into          v1.KeyToPath
items    the specified paths, and unlisted keys will not be present. If a key is        false    array
         specified which is not present in the ConfigMap, the volume setup will error
         unless it is marked optional. Paths must be relative and may not contain the
         .. path or start with ...

optional Specify whether the ConfigMap or it’s keys must be defined                     false    boolean      false

v1.PhotonPersistentDiskVolumeSource

Represents a Photon Controller persistent disk resource.

 Name                              Description                              Required Schema Default
pdID   ID that identifies Photon Controller persistent disk                 true     string

       Filesystem type to mount. Must be a filesystem type supported by the
fsType host operating system. Ex. "ext4", "xfs", "ntfs". Implicitly         false    string
       inferred to be "ext4" if unspecified.

v1.ScaleIOVolumeSource

ScaleIOVolumeSource represents a persistent ScaleIO volume

      Name                      Description                Required         Schema          Default
gateway          The host address of the ScaleIO API       true     string
                 Gateway.

system           The name of the storage system as         true     string
                 configured in ScaleIO.

                 SecretRef references to the secret for
secretRef        ScaleIO user and other sensitive          true     v1.LocalObjectReference
                 information. If this is not provided,
                 Login operation will fail.

sslEnabled       Flag to enable/disable SSL communication  false    boolean                 false
                 with Gateway, default false

                 The name of the Protection Domain for the
protectionDomain configured storage (defaults to           false    string
                 "default").

                 The Storage Pool associated with the
storagePool      protection domain (defaults to            false    string
                 "default").

                 Indicates whether the storage for a
storageMode      volume should be thick or thin (defaults  false    string
                 to "thin").

                 The name of a volume already created in
volumeName       the ScaleIO system that is associated     false    string
                 with this volume source.

                 Filesystem type to mount. Must be a
                 filesystem type supported by the host
fsType           operating system. Ex. "ext4", "xfs",      false    string
                 "ntfs". Implicitly inferred to be "ext4"
                 if unspecified.

                 Defaults to false (read/write). ReadOnly
readOnly         here will force the ReadOnly setting in   false    boolean                 false
                 VolumeMounts.

v1.HostPathType

v1.Initializers

Initializers tracks the progress of initialization.

 Name                           Description                         Required     Schema     Default
        Pending is a list of initializers that must execute in
        order before this object is visible. When the last pending           v1.Initializer
pending initializer is removed, and no failing result is set, the   true     array
        initializers struct will be set to nil and the object is
        considered as initialized and visible to all clients.

        If result is set with the Failure field, the object will be
result  persisted to storage and then deleted, ensuring that other  false    v1.Status
        clients can observe the deletion.

v1.Status

Status is a return value for calls that don’t return other objects.

   Name                                       Description                                     Required      Schema      Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to. Cannot be false    string
           updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and may    false    string
           reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard list metadata. More info:                                                 false    v1.ListMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

status     Status of the operation. One of: "Success" or "Failure". More info:                false    string
           https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

message    A human-readable description of the status of this operation.                      false    string

           A machine-readable description of why this operation is in the "Failure" status.
reason     If this value is empty there is no information available. A Reason clarifies an    false    string
           HTTP status code but does not override it.

           Extended data associated with the reason. Each reason may define its own extended
details    details. This field is optional and the data returned is not guaranteed to conform false    v1.StatusDetails
           to any schema except that defined by the reason type.

code       Suggested HTTP return code for this status, 0 if not set.                          false    integer (int32)

v1beta1.ScaleStatus

represents the current status of a scale subresource.

     Name                                             Description                                        Required Schema  Default
replicas       actual number of observed instances of the scaled object.                                 true     integer
                                                                                                                  (int32)

selector       label query over pods that should match the replicas count. More info:                    false    object
               http://kubernetes.io/docs/user-guide/labels#label-selectors

               label selector for pods that should match the replicas count. This is a serializated
               version of both map-based and more expressive set-based selectors. This is done to avoid
targetSelector introspection in the clients. The string will be in the same format as the query-param    false    string
               syntax. If the target type only supports map-based selectors, both this field and
               map-based selector field are populated. More info:
               https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors

v1.NFSVolumeSource

Represents an NFS mount that lasts the lifetime of a pod. NFS volumes do not support ownership
management or SELinux relabeling.

  Name                              Description                            Required Schema  Default
server   Server is the hostname or IP address of the NFS server. More      true     string
         info: https://kubernetes.io/docs/concepts/storage/volumes#nfs

path     Path that is exported by the NFS server. More info:               true     string
         https://kubernetes.io/docs/concepts/storage/volumes#nfs

         ReadOnly here will force the NFS export to be mounted with
readOnly read-only permissions. Defaults to false. More info:              false    boolean false
         https://kubernetes.io/docs/concepts/storage/volumes#nfs

v1beta1.DeploymentList

DeploymentList is a list of Deployments.

   Name                                     Description                                   Required       Schema       Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to.       false    string
           Cannot be updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and    false    string
           may reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard list metadata.                                                        false    v1.ListMeta

items      Items is the list of Deployments.                                              true     v1beta1.Deployment
                                                                                                   array

v1beta1.DeploymentRollback

DEPRECATED. DeploymentRollback stores the information required to rollback a deployment.

       Name                                         Description                                   Required         Schema         Default
                   Kind is a string value representing the REST resource this object represents.
kind               Servers may infer this from the endpoint the client submits requests to.       false    string
                   Cannot be updated. In CamelCase. More info:
                   https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

                   APIVersion defines the versioned schema of this representation of an object.
apiVersion         Servers should convert recognized schemas to the latest internal value, and    false    string
                   may reject unrecognized values. More info:
                   https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

name               Required: This must match the Name of a deployment.                            true     string

updatedAnnotations The annotations to be updated to a deployment                                  false    object

rollbackTo         The config of this deployment rollback.                                        true     v1beta1.RollbackConfig

v1.HTTPHeader

HTTPHeader describes a custom header to be used in HTTP probes

Name        Description       Required Schema Default
name  The header field name   true     string

value The header field value  true     string

v1.FCVolumeSource

Represents a Fibre Channel volume. Fibre Channel volumes can only be mounted as read/write once.
Fibre Channel volumes support ownership management and SELinux relabeling.

   Name                              Description                           Required Schema  Default
targetWWNs Optional: FC target worldwide names (WWNs)                      false    string
                                                                                    array

lun        Optional: FC target lun number                                  false    integer
                                                                                    (int32)

           Filesystem type to mount. Must be a filesystem type supported
fsType     by the host operating system. Ex. "ext4", "xfs", "ntfs".        false    string
           Implicitly inferred to be "ext4" if unspecified.

readOnly   Optional: Defaults to false (read/write). ReadOnly here will    false    boolean false
           force the ReadOnly setting in VolumeMounts.

           Optional: FC volume world wide identifiers (wwids) Either wwids          string
wwids      or combination of targetWWNs and lun must be set, but not both  false    array
           simultaneously.

v1.PodAntiAffinity

Pod anti affinity is a group of inter pod anti affinity scheduling rules.

                     Name                             Description        Required           Schema           Default
                                                If the anti-affinity
                                                requirements specified
                                                by this field are not
                                                met at scheduling time,
                                                the pod will not be
                                                scheduled onto the node.
                                                If the anti-affinity
                                                requirements specified
                                                by this field cease to
                                                be met at some point
requiredDuringSchedulingIgnoredDuringExecution  during pod execution     false    v1.PodAffinityTerm array
                                                (e.g. due to a pod label
                                                update), the system may
                                                or may not try to
                                                eventually evict the pod
                                                from its node. When
                                                there are multiple
                                                elements, the lists of
                                                nodes corresponding to
                                                each podAffinityTerm are
                                                intersected, i.e. all
                                                terms must be satisfied.

                                                The scheduler will
                                                prefer to schedule pods
                                                to nodes that satisfy
                                                the anti-affinity
                                                expressions specified by
                                                this field, but it may
                                                choose a node that
                                                violates one or more of
                                                the expressions. The
                                                node that is most
                                                preferred is the one
                                                with the greatest sum of
                                                weights, i.e. for each
                                                node that meets all of
                                                the scheduling                    v1.WeightedPodAffinityTerm
preferredDuringSchedulingIgnoredDuringExecution requirements (resource   false    array
                                                request,
                                                requiredDuringScheduling
                                                anti-affinity
                                                expressions, etc.),
                                                compute a sum by
                                                iterating through the
                                                elements of this field
                                                and adding "weight" to
                                                the sum if the node has
                                                pods which matches the
                                                corresponding
                                                podAffinityTerm; the
                                                node(s) with the highest
                                                sum are the most
                                                preferred.

v1.DeletionPropagation

v1beta1.DeploymentStrategy

DeploymentStrategy describes how to replace existing pods with new ones.

    Name                  Description              Required             Schema              Default
              Type of deployment. Can be
type          "Recreate" or "RollingUpdate".       false    string
              Default is RollingUpdate.

              Rolling update config params.
rollingUpdate Present only if                      false    v1beta1.RollingUpdateDeployment
              DeploymentStrategyType =
              RollingUpdate.

v1.TCPSocketAction

TCPSocketAction describes an action based on opening a socket

Name                              Description                               Required Schema Default
port Number or name of the port to access on the container. Number must be  true     string
     in the range 1 to 65535. Name must be an IANA_SVC_NAME.

host Optional: Host name to connect to, defaults to the pod IP.             false    string

v1beta1.IngressRule

IngressRule represents the rules mapping the paths under a specified host to the related backend
services. Incoming requests are first evaluated for a host match, then routed to the backend
associated with the matching IngressRuleValue.

Name                   Description                    Required            Schema            Default
     Host is the fully qualified domain name of a
     network host, as defined by RFC 3986. Note the
     following deviations from the "host" part of the
     URI as defined in the RFC: 1. IPs are not
     allowed. Currently an IngressRuleValue can only
     apply to the
     IP in the Spec of the parent Ingress.
     2. The : delimiter is not respected because
host ports are not allowed.                           false    string
     Currently the port of an Ingress is implicitly
     :80 for http and
     :443 for https.
     Both these may change in the future. Incoming
     requests are matched against the host before the
     IngressRuleValue. If the host is unspecified,
     the Ingress routes all traffic based on the
     specified IngressRuleValue.

http                                                  false    v1beta1.HTTPIngressRuleValue

v1.HTTPGetAction

HTTPGetAction describes an action based on HTTP Get requests.

   Name                           Description                        Required    Schema     Default
path        Path to access on the HTTP server.                       false    string

            Name or number of the port to access on the container.
port        Number must be in the range 1 to 65535. Name must be an  true     string
            IANA_SVC_NAME.

host        Host name to connect to, defaults to the pod IP. You     false    string
            probably want to set "Host" in httpHeaders instead.

scheme      Scheme to use for connecting to the host. Defaults to    false    string
            HTTP.

httpHeaders Custom headers to set in the request. HTTP allows        false    v1.HTTPHeader
            repeated headers.                                                 array

v1.StatusDetails

StatusDetails is a set of additional properties that MAY be set by the server to provide additional
information about a response. The Reason field of a Status object defines what attributes will be
set. Clients must ignore fields that do not match the defined type of each attribute, and should
assume that any attribute may be empty, invalid, or under defined.

      Name                                         Description                                   Required     Schema     Default
name              The name attribute of the resource associated with the status StatusReason     false    string
                  (when there is a single name which can be described).

group             The group attribute of the resource associated with the status StatusReason.   false    string

                  The kind attribute of the resource associated with the status StatusReason. On
kind              some operations may differ from the requested resource Kind. More info:        false    string
                  https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

uid               UID of the resource. (when there is a single resource which can be described). false    string
                  More info: http://kubernetes.io/docs/user-guide/identifiers#uids

causes            The Causes array includes more details associated with the StatusReason        false    v1.StatusCause
                  failure. Not all StatusReasons may provide detailed causes.                             array

                  If specified, the time in seconds before the operation should be retried. Some
retryAfterSeconds errors may indicate the client must take an alternate action - for those       false    integer
                  errors this field may indicate how long to wait before taking the alternate             (int32)
                  action.

v1.LoadBalancerStatus

LoadBalancerStatus represents the status of a load-balancer.

 Name                       Description                     Required         Schema         Default
        Ingress is a list containing ingress points for the          v1.LoadBalancerIngress
ingress load-balancer. Traffic intended for the service     false    array
        should be sent to these ingress points.

v1.Container

A single application container that you want to run within a pod.

          Name                                                                 Description                                                        Required         Schema          Default
name                     Name of the container specified as a DNS_LABEL. Each container in a pod must have a unique name                          true     string
                         (DNS_LABEL). Cannot be updated.

                         Docker image name. More info: https://kubernetes.io/docs/concepts/containers/images This field is
image                    optional to allow higher level config management to default or override container images in                              false    string
                         workload controllers like Deployments and StatefulSets.

                         Entrypoint array. Not executed within a shell. The docker image’s ENTRYPOINT is used if this is not
                         provided. Variable references $(VAR_NAME) are expanded using the container’s environment. If a
command                  variable cannot be resolved, the reference in the input string will be unchanged. The $(VAR_NAME)                        false    string array
                         syntax can be escaped with a double $$, ie: $$(VAR_NAME). Escaped references will never be
                         expanded, regardless of whether the variable exists or not. Cannot be updated. More info:
                         https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#running-a-command-in-a-shell

                         Arguments to the entrypoint. The docker image’s CMD is used if this is not provided. Variable
                         references $(VAR_NAME) are expanded using the container’s environment. If a variable cannot be
args                     resolved, the reference in the input string will be unchanged. The $(VAR_NAME) syntax can be                             false    string array
                         escaped with a double $$, ie: $$(VAR_NAME). Escaped references will never be expanded, regardless
                         of whether the variable exists or not. Cannot be updated. More info:
                         https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#running-a-command-in-a-shell

workingDir               Container’s working directory. If not specified, the container runtime’s default will be used,                           false    string
                         which might be configured in the container image. Cannot be updated.

                         List of ports to expose from the container. Exposing a port here gives the system additional
                         information about the network connections a container uses, but is primarily informational. Not
ports                    specifying a port here DOES NOT prevent that port from being exposed. Any port which is listening                        false    v1.ContainerPort array
                         on the default "0.0.0.0" address inside a container will be accessible from the network. Cannot be
                         updated.

                         List of sources to populate environment variables in the container. The keys defined within a
                         source must be a C_IDENTIFIER. All invalid keys will be reported as an event when the container is
envFrom                  starting. When a key exists in multiple sources, the value associated with the last source will                          false    v1.EnvFromSource array
                         take precedence. Values defined by an Env with a duplicate key will take precedence. Cannot be
                         updated.

env                      List of environment variables to set in the container. Cannot be updated.                                                false    v1.EnvVar array

resources                Compute Resources required by this container. Cannot be updated. More info:                                              false    v1.ResourceRequirements
                         https://kubernetes.io/docs/concepts/storage/persistent-volumes#resources

volumeMounts             Pod volumes to mount into the container’s filesystem. Cannot be updated.                                                 false    v1.VolumeMount array

                         Periodic probe of container liveness. Container will be restarted if the probe fails. Cannot be
livenessProbe            updated. More info:                                                                                                      false    v1.Probe
                         https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle#container-probes

                         Periodic probe of container service readiness. Container will be removed from service endpoints if
readinessProbe           the probe fails. Cannot be updated. More info:                                                                           false    v1.Probe
                         https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle#container-probes

lifecycle                Actions that the management system should take in response to container lifecycle events. Cannot be                      false    v1.Lifecycle
                         updated.

                         Optional: Path at which the file to which the container’s termination message will be written is
                         mounted into the container’s filesystem. Message written is intended to be brief final status, such
terminationMessagePath   as an assertion failure message. Will be truncated by the node if greater than 4096 bytes. The                           false    string
                         total message length across all containers will be limited to 12kb. Defaults to /dev/
                         termination-log. Cannot be updated.

                         Indicate how the termination message should be populated. File will use the contents of
                         terminationMessagePath to populate the container status message on both success and failure.
terminationMessagePolicy FallbackToLogsOnError will use the last chunk of container log output if the termination message                         false    string
                         file is empty and the container exited with an error. The log output is limited to 2048 bytes or 80
                         lines, whichever is smaller. Defaults to File. Cannot be updated.

                         Image pull policy. One of Always, Never, IfNotPresent. Defaults to Always if :latest tag is
imagePullPolicy          specified, or IfNotPresent otherwise. Cannot be updated. More info:                                                      false    string
                         https://kubernetes.io/docs/concepts/containers/images#updating-images

                         Security options the pod should run with. More info:
securityContext          https://kubernetes.io/docs/concepts/policy/security-context/ More info:                                                  false    v1.SecurityContext
                         https://git.k8s.io/community/contributors/design-proposals/security_context.md

stdin                    Whether this container should allocate a buffer for stdin in the container runtime. If this is not                       false    boolean                 false
                         set, reads from stdin in the container will always result in EOF. Default is false.

                         Whether the container runtime should close the stdin channel after it has been opened by a single
                         attach. When stdin is true the stdin stream will remain open across multiple attach sessions. If
stdinOnce                stdinOnce is set to true, stdin is opened on container start, is empty until the first client                            false    boolean                 false
                         attaches to stdin, and then remains open and accepts data until the client disconnects, at which
                         time stdin is closed and remains closed until the container is restarted. If this flag is false, a
                         container processes that reads from stdin will never receive an EOF. Default is false

tty                      Whether this container should allocate a TTY for itself, also requires stdin to be true. Default is                      false    boolean                 false
                         false.

v1.PodSecurityContext

PodSecurityContext holds pod-level security attributes and common container settings. Some fields
are also present in container.securityContext. Field values of container.securityContext take
precedence over field values of PodSecurityContext.

       Name                         Description                  Required      Schema       Default
                   The SELinux context to be applied to all
                   containers. If unspecified, the container
                   runtime will allocate a random SELinux
seLinuxOptions     context for each container. May also be set   false    v1.SELinuxOptions
                   in SecurityContext. If set in both
                   SecurityContext and PodSecurityContext, the
                   value specified in SecurityContext takes
                   precedence for that container.

                   The UID to run the entrypoint of the
                   container process. Defaults to user specified
                   in image metadata if unspecified. May also be
runAsUser          set in SecurityContext. If set in both        false    integer (int64)
                   SecurityContext and PodSecurityContext, the
                   value specified in SecurityContext takes
                   precedence for that container.

                   Indicates that the container must run as a
                   non-root user. If true, the Kubelet will
                   validate the image at runtime to ensure that
                   it does not run as UID 0 (root) and fail to
runAsNonRoot       start the container if it does. If unset or   false    boolean           false
                   false, no such validation will be performed.
                   May also be set in SecurityContext. If set in
                   both SecurityContext and PodSecurityContext,
                   the value specified in SecurityContext takes
                   precedence.

                   A list of groups applied to the first process
supplementalGroups run in each container, in addition to the     false    integer (int32)
                   container’s primary GID. If unspecified, no            array
                   groups will be added to any container.

                   A special supplemental group that applies to
                   all containers in a pod. Some volume types
                   allow the Kubelet to change the ownership of
                   that volume to be owned by the pod:
fsGroup                                                          false    integer (int64)
                   1. The owning GID will be the FSGroup 2. The
                   setgid bit is set (new files created in the
                   volume will be owned by FSGroup) 3. The
                   permission bits are OR’d with rw-rw

v1.OwnerReference

OwnerReference contains enough information to let you identify an owning object. Currently, an
owning object must be in the same namespace, so there is no namespace field.

       Name                                         Description                                   Required Schema  Default
apiVersion         API version of the referent.                                                   true     string

kind               Kind of the referent. More info:                                               true     string
                   https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

name               Name of the referent. More info:                                               true     string
                   http://kubernetes.io/docs/user-guide/identifiers#names

uid                UID of the referent. More info:                                                true     string
                   http://kubernetes.io/docs/user-guide/identifiers#uids

controller         If true, this reference points to the managing controller.                     false    boolean false

                   If true, AND if the owner has the "foregroundDeletion" finalizer, then the
                   owner cannot be deleted from the key-value store until this reference is
blockOwnerDeletion removed. Defaults to false. To set this field, a user needs "delete"           false    boolean false
                   permission of the owner, otherwise 422 (Unprocessable Entity) will be
                   returned.

v1beta1.ReplicaSetStatus

ReplicaSetStatus represents the current status of a ReplicaSet.

        Name                                                           Description                                                    Required           Schema            Default
replicas             Replicas is the most recently oberved number of replicas. More info:                                             true     integer (int32)
                     https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller/#what-is-a-replicationcontroller

fullyLabeledReplicas The number of pods that have labels matching the labels of the pod template of the replicaset.                   false    integer (int32)

readyReplicas        The number of ready replicas for this replica set.                                                               false    integer (int32)

availableReplicas    The number of available replicas (ready for at least minReadySeconds) for this replica set.                      false    integer (int32)

observedGeneration   ObservedGeneration reflects the generation of the most recently observed ReplicaSet.                             false    integer (int64)

conditions           Represents the latest available observations of a replica set’s current state.                                   false    v1beta1.ReplicaSetCondition
                                                                                                                                               array

v1.APIResource

APIResource specifies the name of a resource and whether it is namespaced.

    Name                              Description                          Required Schema  Default
name         name is the plural name of the resource.                      true     string

             singularName is the singular name of the resource. This
             allows clients to handle plural and singular opaquely. The
singularName singularName is more correct for reporting status on a single true     string
             item and both singular and plural are allowed from the
             kubectl CLI interface.

namespaced   namespaced indicates if a resource is namespaced or not.      true     boolean false

             group is the preferred group of the resource. Empty implies
group        the group of the containing resource list. For subresources,  false    string
             this may have a different value, for example: Scale".

             version is the preferred version of the resource. Empty
             implies the version of the containing resource list For
version      subresources, this may have a different value, for example:   false    string
             v1 (while inside a v1beta1 version of the core resource’s
             group)".

kind         kind is the kind for the resource (e.g. Foo is the kind for a true     string
             resource foo)

             verbs is a list of supported kube verbs (this includes get,            string
verbs        list, watch, create, update, patch, delete, deletecollection, true     array
             and proxy)

shortNames   shortNames is a list of suggested short names of the          false    string
             resource.                                                              array

categories   categories is a list of the grouped resources this resource   false    string
             belongs to (e.g. all)                                                  array

v1.NodeSelectorRequirement

A node selector requirement is a selector that contains values, a key, and an operator that relates
the key and values.

  Name                              Description                             Required Schema Default
key      The label key that the selector applies to.                        true     string

operator Represents a key’s relationship to a set of values. Valid          true     string
         operators are In, NotIn, Exists, DoesNotExist. Gt, and Lt.

         An array of string values. If the operator is In or NotIn, the
         values array must be non-empty. If the operator is Exists or
values   DoesNotExist, the values array must be empty. If the operator is   false    string
         Gt or Lt, the values array must have a single element, which will           array
         be interpreted as an integer. This array is replaced during a
         strategic merge patch.

v1beta1.ReplicaSet

DEPRECATED - This group version of ReplicaSet is deprecated by apps/v1beta2/ReplicaSet. See the
release notes for more information. ReplicaSet represents the configuration of a ReplicaSet.

   Name                                       Description                                     Required          Schema          Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to. Cannot be false    string
           updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and may    false    string
           reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

           If the Labels of a ReplicaSet are empty, they are defaulted to be the same as the
metadata   Pod(s) that the ReplicaSet manages. Standard object’s metadata. More info:         false    v1.ObjectMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

           Spec defines the specification of the desired behavior of the ReplicaSet. More
spec       info:                                                                              false    v1beta1.ReplicaSetSpec
           https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

           Status is the most recently observed status of the ReplicaSet. This data may be
status     out of date by some window of time. Populated by the system. Read-only. More info: false    v1beta1.ReplicaSetStatus
           https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

v1.HostPathVolumeSource

Represents a host path mapped into a pod. Host path volumes do not support ownership management or
SELinux relabeling.

Name                          Description                          Required     Schema      Default
     Path of the directory on the host. If the path is a symlink,
path it will follow the link to the real path. More info:          true     string
     https://kubernetes.io/docs/concepts/storage/volumes#hostpath

type Type for HostPath Volume Defaults to "" More info:            false    v1.HostPathType
     https://kubernetes.io/docs/concepts/storage/volumes#hostpath

v1.SecretProjection

Adapts a secret into a projected volume.

The contents of the target Secret’s Data field will be presented in a projected volume as files
using the keys in the Data field as the file names. Note that this is identical to a secret volume
source without the default mode.

  Name                                    Description                                   Required    Schema    Default
name     Name of the referent. More info:                                               false    string
         https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

         If unspecified, each key-value pair in the Data field of the referenced Secret
         will be projected into the volume as a file whose name is the key and content
         is the value. If specified, the listed keys will be projected into the                  v1.KeyToPath
items    specified paths, and unlisted keys will not be present. If a key is specified  false    array
         which is not present in the Secret, the volume setup will error unless it is
         marked optional. Paths must be relative and may not contain the .. path or
         start with ...

optional Specify whether the Secret or its key must be defined                          false    boolean      false

v1beta1.DaemonSet

DEPRECATED - This group version of DaemonSet is deprecated by apps/v1beta2/DaemonSet. See the
release notes for more information. DaemonSet represents the configuration of a daemon set.

   Name                                       Description                                     Required         Schema          Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to. Cannot be false    string
           updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and may    false    string
           reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard object’s metadata. More info:                                             false    v1.ObjectMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

spec       The desired behavior of this daemon set. More info:                                false    v1beta1.DaemonSetSpec
           https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

           The current status of this daemon set. This data may be out of date by some window
status     of time. Populated by the system. Read-only. More info:                            false    v1beta1.DaemonSetStatus
           https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

v1.CinderVolumeSource

Represents a cinder volume resource in Openstack. A Cinder volume must exist before mounting to a
container. The volume must also be in the same region as the kubelet. Cinder volumes support
ownership management and SELinux relabeling.

  Name                              Description                            Required Schema  Default
volumeID volume id used to identify the volume in cinder More info:        true     string
         https://releases.k8s.io/HEAD/examples/mysql-cinder-pd/README.md

         Filesystem type to mount. Must be a filesystem type supported by
fsType   the host operating system. Examples: "ext4", "xfs", "ntfs".       false    string
         Implicitly inferred to be "ext4" if unspecified. More info:
         https://releases.k8s.io/HEAD/examples/mysql-cinder-pd/README.md

         Optional: Defaults to false (read/write). ReadOnly here will
readOnly force the ReadOnly setting in VolumeMounts. More info:            false    boolean false
         https://releases.k8s.io/HEAD/examples/mysql-cinder-pd/README.md

v1.SecurityContext

SecurityContext holds security configuration that will be applied to a container. Some fields are
present in both SecurityContext and PodSecurityContext. When both are set, the values in
SecurityContext take precedence.

          Name                         Description               Required      Schema       Default
                         The capabilities to add/drop when
capabilities             running containers. Defaults to the     false    v1.Capabilities
                         default set of capabilities granted by
                         the container runtime.

                         Run container in privileged mode.
privileged               Processes in privileged containers are  false    boolean           false
                         essentially equivalent to root on the
                         host. Defaults to false.

                         The SELinux context to be applied to
                         the container. If unspecified, the
                         container runtime will allocate a
                         random SELinux context for each
seLinuxOptions           container. May also be set in           false    v1.SELinuxOptions
                         PodSecurityContext. If set in both
                         SecurityContext and PodSecurityContext,
                         the value specified in SecurityContext
                         takes precedence.

                         The UID to run the entrypoint of the
                         container process. Defaults to user
                         specified in image metadata if
runAsUser                unspecified. May also be set in         false    integer (int64)
                         PodSecurityContext. If set in both
                         SecurityContext and PodSecurityContext,
                         the value specified in SecurityContext
                         takes precedence.

                         Indicates that the container must run
                         as a non-root user. If true, the
                         Kubelet will validate the image at
                         runtime to ensure that it does not run
                         as UID 0 (root) and fail to start the
runAsNonRoot             container if it does. If unset or       false    boolean           false
                         false, no such validation will be
                         performed. May also be set in
                         PodSecurityContext. If set in both
                         SecurityContext and PodSecurityContext,
                         the value specified in SecurityContext
                         takes precedence.

readOnlyRootFilesystem   Whether this container has a read-only  false    boolean           false
                         root filesystem. Default is false.

                         AllowPrivilegeEscalation controls
                         whether a process can gain more
                         privileges than its parent process.
                         This bool directly controls if the
allowPrivilegeEscalation no_new_privs flag will be set on the    false    boolean           false
                         container process.
                         AllowPrivilegeEscalation is true always
                         when the container is: 1) run as
                         Privileged 2) has CAP_SYS_ADMIN

v1.AWSElasticBlockStoreVolumeSource

Represents a Persistent Disk resource in AWS.

An AWS EBS disk must exist before mounting to a container. The disk must also be in the same AWS
zone as the kubelet. An AWS EBS disk can only be mounted as read/write once. AWS EBS volumes
support ownership management and SELinux relabeling.

  Name                                  Description                                Required Schema  Default
          Unique ID of the persistent disk resource in AWS (Amazon EBS volume).
volumeID  More info:                                                               true     string
          https://kubernetes.io/docs/concepts/storage/volumes#awselasticblockstore

          Filesystem type of the volume that you want to mount. Tip: Ensure that
          the filesystem type is supported by the host operating system. Examples:
fsType    "ext4", "xfs", "ntfs". Implicitly inferred to be "ext4" if unspecified.  false    string
          More info:
          https://kubernetes.io/docs/concepts/storage/volumes#awselasticblockstore

          The partition in the volume that you want to mount. If omitted, the
partition default is to mount by volume name. Examples: For volume /dev/sda1, you  false    integer
          specify the partition as "1". Similarly, the volume partition for /dev/           (int32)
          sda is "0" (or you can leave the property empty).

          Specify "true" to force and set the ReadOnly property in VolumeMounts to
readOnly  "true". If omitted, the default is "false". More info:                   false    boolean false
          https://kubernetes.io/docs/concepts/storage/volumes#awselasticblockstore

v1.QuobyteVolumeSource

Represents a Quobyte mount that lasts the lifetime of a pod. Quobyte volumes do not support
ownership management or SELinux relabeling.

  Name                              Description                            Required Schema  Default
         Registry represents a single or multiple Quobyte Registry
registry services specified as a string as host:port pair (multiple        true     string
         entries are separated with commas) which acts as the central
         registry for volumes

volume   Volume is a string that references an already created Quobyte     true     string
         volume by name.

readOnly ReadOnly here will force the Quobyte volume to be mounted with    false    boolean false
         read-only permissions. Defaults to false.

user     User to map volume access to Defaults to serivceaccount user      false    string

group    Group to map volume access to Default is no group                 false    string

v1.WatchEvent

 Name  Description  Required Schema Default
type                true     string

object              true     string

v1.LabelSelectorRequirement

A label selector requirement is a selector that contains values, a key, and an operator that
relates the key and values.

  Name                              Description                             Required Schema Default
key      key is the label key that the selector applies to.                 true     string

operator operator represents a key’s relationship to a set of values. Valid true     string
         operators are In, NotIn, Exists and DoesNotExist.

         values is an array of string values. If the operator is In or
values   NotIn, the values array must be non-empty. If the operator is      false    string
         Exists or DoesNotExist, the values array must be empty. This array          array
         is replaced during a strategic merge patch.

v1.EnvVar

EnvVar represents an environment variable present in a Container.

  Name                          Description                        Required     Schema      Default
name      Name of the environment variable. Must be a              true     string
          C_IDENTIFIER.

          Variable references $(VAR_NAME) are expanded using the
          previous defined environment variables in the container
          and any service environment variables. If a variable
value     cannot be resolved, the reference in the input string    false    string
          will be unchanged. The $(VAR_NAME) syntax can be escaped
          with a double $$, ie: $$(VAR_NAME). Escaped references
          will never be expanded, regardless of whether the
          variable exists or not. Defaults to "".

valueFrom Source for the environment variable’s value. Cannot be   false    v1.EnvVarSource
          used if value is not empty.

v1.ResourceRequirements

ResourceRequirements describes the compute resource requirements.

  Name                                        Description                                      Required Schema Default
limits   Limits describes the maximum amount of compute resources allowed. More info:          false    object
         https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/

         Requests describes the minimum amount of compute resources required. If Requests is
requests omitted for a container, it defaults to Limits if that is explicitly specified,       false    object
         otherwise to an implementation-defined value. More info:
         https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/

v1.HostAlias

HostAlias holds the mapping between IP and hostnames that will be injected as an entry in the pod’s
hosts file.

  Name                Description             Required    Schema    Default
ip        IP address of the host file entry.  false    string

hostnames Hostnames for the above IP address. false    string array

v1.PodTemplateSpec

PodTemplateSpec describes the data a pod should have when created from a template

  Name                                      Description                                     Required    Schema     Default
metadata Standard object’s metadata. More info:                                             false    v1.ObjectMeta
         https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

spec     Specification of the desired behavior of the pod. More info:                       false    v1.PodSpec
         https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

v1.NodeSelector

A node selector represents the union of the results of one or more label queries over a set of
nodes; that is, it represents the OR of the selectors represented by the node selector terms.

      Name                        Description                  Required       Schema        Default
nodeSelectorTerms Required. A list of node selector terms. The true     v1.NodeSelectorTerm
                  terms are ORed.                                       array

v1.Patch

Patch is provided to give a concrete name and type to the Kubernetes PATCH request body.

v1beta1.DeploymentCondition

DeploymentCondition describes the state of a deployment at a certain point.

       Name                              Description                        Required Schema Default
type               Type of deployment condition.                            true     string

status             Status of the condition, one of True, False, Unknown.    true     string

lastUpdateTime     The last time this condition was updated.                false    string

lastTransitionTime Last time the condition transitioned from one status to  false    string
                   another.

reason             The reason for the condition’s last transition.          false    string

message            A human readable message indicating details about the    false    string
                   transition.

v1.ConfigMapEnvSource

ConfigMapEnvSource selects a ConfigMap to populate the environment variables with.

The contents of the target ConfigMap’s Data field will represent the key-value pairs as environment
variables.

  Name                                    Description                                   Required Schema  Default
name     Name of the referent. More info:                                               false    string
         https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

optional Specify whether the ConfigMap must be defined                                  false    boolean false

v1.StorageOSVolumeSource

Represents a StorageOS persistent volume resource.

     Name                      Description                 Required         Schema          Default
                VolumeName is the human-readable name of
volumeName      the StorageOS volume. Volume names are     false    string
                only unique within a namespace.

                VolumeNamespace specifies the scope of the
                volume within StorageOS. If no namespace
                is specified then the Pod’s namespace will
                be used. This allows the Kubernetes name
                scoping to be mirrored within StorageOS
volumeNamespace for tighter integration. Set VolumeName to false    string
                any name to override the default
                behaviour. Set to "default" if you are not
                using namespaces within StorageOS.
                Namespaces that do not pre-exist within
                StorageOS will be created.

                Filesystem type to mount. Must be a
                filesystem type supported by the host
fsType          operating system. Ex. "ext4", "xfs",       false    string
                "ntfs". Implicitly inferred to be "ext4"
                if unspecified.

                Defaults to false (read/write). ReadOnly
readOnly        here will force the ReadOnly setting in    false    boolean                 false
                VolumeMounts.

                SecretRef specifies the secret to use for
secretRef       obtaining the StorageOS API credentials.   false    v1.LocalObjectReference
                If not specified, default values will be
                attempted.

v1.NodeAffinity

Node affinity is a group of node affinity scheduling rules.

                     Name                             Description        Required           Schema           Default
                                                If the affinity
                                                requirements specified
                                                by this field are not
                                                met at scheduling time,
                                                the pod will not be
                                                scheduled onto the node.
                                                If the affinity
requiredDuringSchedulingIgnoredDuringExecution  requirements specified   false    v1.NodeSelector
                                                by this field cease to
                                                be met at some point
                                                during pod execution
                                                (e.g. due to an update),
                                                the system may or may
                                                not try to eventually
                                                evict the pod from its
                                                node.

                                                The scheduler will
                                                prefer to schedule pods
                                                to nodes that satisfy
                                                the affinity expressions
                                                specified by this field,
                                                but it may choose a node
                                                that violates one or
                                                more of the expressions.
                                                The node that is most
                                                preferred is the one
                                                with the greatest sum of
                                                weights, i.e. for each
                                                node that meets all of
                                                the scheduling                    v1.PreferredSchedulingTerm
preferredDuringSchedulingIgnoredDuringExecution requirements (resource   false    array
                                                request,
                                                requiredDuringScheduling
                                                affinity expressions,
                                                etc.), compute a sum by
                                                iterating through the
                                                elements of this field
                                                and adding "weight" to
                                                the sum if the node
                                                matches the
                                                corresponding
                                                matchExpressions; the
                                                node(s) with the highest
                                                sum are the most
                                                preferred.

v1.AzureDataDiskKind

v1.PreferredSchedulingTerm

An empty preferred scheduling term matches all objects with implicit weight 0 (i.e. it’s a no-op).
A null preferred scheduling term matches no objects (i.e. is also a no-op).

   Name                        Description                     Required       Schema        Default
weight     Weight associated with matching the corresponding   true     integer (int32)
           nodeSelectorTerm, in the range 1-100.

preference A node selector term, associated with the           true     v1.NodeSelectorTerm
           corresponding weight.

v1.ConfigMapKeySelector

Selects a key from a ConfigMap.

  Name                                    Description                                   Required Schema  Default
name     Name of the referent. More info:                                               false    string
         https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names

key      The key to select.                                                             true     string

optional Specify whether the ConfigMap or it’s key must be defined                      false    boolean false

v1beta1.HTTPIngressPath

HTTPIngressPath associates a path regex with a backend. Incoming urls matching the path are
forwarded to the backend.

 Name                       Description                     Required         Schema         Default
        Path is an extended POSIX regex as defined by IEEE
        Std 1003.1, (i.e this follows the egrep/unix
        syntax, not the perl syntax) matched against the
        path of an incoming request. Currently it can
path    contain characters disallowed from the conventional false    string
        "path" part of a URL as defined by RFC 3986. Paths
        must begin with a /. If unspecified, the path
        defaults to a catch all sending traffic to the
        backend.

backend Backend defines the referenced service endpoint to  true     v1beta1.IngressBackend
        which the traffic will be forwarded to.

v1beta1.Ingress

Ingress is a collection of rules that allow inbound connections to reach the endpoints defined by a
backend. An Ingress can be configured to give services externally-reachable urls, load balance
traffic, terminate SSL, offer name based virtual hosting etc.

   Name                                       Description                                     Required        Schema         Default
           Kind is a string value representing the REST resource this object represents.
kind       Servers may infer this from the endpoint the client submits requests to. Cannot be false    string
           updated. In CamelCase. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds

           APIVersion defines the versioned schema of this representation of an object.
apiVersion Servers should convert recognized schemas to the latest internal value, and may    false    string
           reject unrecognized values. More info:
           https://git.k8s.io/community/contributors/devel/api-conventions.md#resources

metadata   Standard object’s metadata. More info:                                             false    v1.ObjectMeta
           https://git.k8s.io/community/contributors/devel/api-conventions.md#metadata

spec       Spec is the desired state of the Ingress. More info:                               false    v1beta1.IngressSpec
           https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

status     Status is the current state of the Ingress. More info:                             false    v1beta1.IngressStatus
           https://git.k8s.io/community/contributors/devel/api-conventions.md#spec-and-status

v1.AzureDataDiskCachingMode

any

Represents an untyped JSON map - see the description of the field for more info about the structure
of this object.

Analytics

Create an Issue Edit this Page
Get Started Documentation Blog Partners Community Case Studies
twitter Github Slack
Stack Overflow Mailing List Events Calendar
Get Kubernetes Contribute
© 2017 The Kubernetes Authors | Documentation Distributed under CC BY 4.0
Copyright © 2017 The Linux Foundation®. All rights reserved. The Linux Foundation has registered
trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our
Trademark Usage page: https://www.linuxfoundation.org/trademark-usage

#+end_example
** useful link
https://jimmysong.io/posts/from-kubernetes-to-cloud-native/
** DONE k8s cronjob
  CLOSED: [2018-01-03 Wed 12:26]
https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/

kubectl create -f ./cronjob.yaml
kubectl get cronjob hello
kubectl get jobs --watch
kubectl delete cronjob hello

#+BEGIN_EXAMPLE
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: "*/1 * * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: hello
            image: busybox
            args:
            - /bin/sh
            - -c
            - date; echo Hello from the Kubernetes cluster
          restartPolicy: OnFailure
#+END_EXAMPLE
** DONE [#B] check k8s status: kubectl get cs
   CLOSED: [2018-01-03 Wed 11:57]
** BYPASS crictl not found in system path: warning
   CLOSED: [2018-01-03 Wed 12:36]
** DONE kubernetes default service type: ClusterIP
   CLOSED: [2018-01-02 Tue 11:07]
** DONE kubectl get nodes: Unable to connect to the server: x509: certificate signed by unknown authority: incorrect /etc/kubernetes/admin.conf
  CLOSED: [2018-01-04 Thu 00:09]


root@k8s1:~# kubectl get nodes
Unable to connect to the server: x509: certificate signed by unknown authority (possibly because of "crypto/rsa: verification error" while trying to verify candidate authority certificate "kubernetes")
root@k8s1:~# echo $KUBECONFIG

root@k8s1:~# export KUBECONFIG=/etc/kubernetes/admin.conf
root@k8s1:~# kubectl get nodes
NAME      STATUS     ROLES     AGE       VERSION
k8s1      Ready      master    29m       v1.9.0
k8s2      NotReady   <none>    17m       v1.9.0
** DONE [#A] kubernetes-the-hard-way: https://github.com/kelseyhightower/kubernetes-the-hard-way
   CLOSED: [2017-12-04 Mon 15:49]
*** CANCELED k8s hardway: etcdctl: Error:  context deadline exceeded
  CLOSED: [2017-12-04 Mon 17:54]
https://github.com/kelseyhightower/kubernetes-the-hard-way/blob/e8d728d0162ebcdf951464caa8be3a5b156eb463/docs/07-bootstrapping-etcd.md
#+BEGIN_EXAMPLE
mac@controller-0:~$ ETCDCTL_API=3 etcdctl member list
Error:  context deadline exceeded
#+END_EXAMPLE

#+BEGIN_EXAMPLE
mac@controller-0:~$ kubectl get componentstatuses
NAME                 STATUS      MESSAGE                                                                                          ERROR
etcd-2               Unhealthy   Get https://10.240.0.12:2379/health: dial tcp 10.240.0.12:2379: getsockopt: connection refused
controller-manager   Healthy     ok
etcd-1               Unhealthy   Get https://10.240.0.11:2379/health: dial tcp 10.240.0.11:2379: getsockopt: connection refused
scheduler            Healthy     ok
etcd-0               Unhealthy   Get https://10.240.0.10:2379/health: net/http: TLS handshake timeout
#+END_EXAMPLE
** DONE k8s livenessProbe(when to restart a Container), readinessProbe(when is ready to accept requests)
  CLOSED: [2018-01-08 Mon 07:41]
https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/
http://kubernetesbyexample.com/healthz/
https://kubernetes-v1-4.github.io/docs/user-guide/liveness/
https://github.com/arun-gupta/kubernetes-java-sample/blob/master/wildfly-pod-hc-http.yaml
http://kubernetesbyexample.com/healthz/

Probes have a number of fields that you can use to more precisely control the behavior of liveness and readiness checks:

initialDelaySeconds: Number of seconds after the container has started before liveness or readiness probes are initiated.
periodSeconds: How often (in seconds) to perform the probe. Default to 10 seconds. Minimum value is 1.
timeoutSeconds: Number of seconds after which the probe times out. Defaults to 1 second. Minimum value is 1.
successThreshold: Minimum consecutive successes for the probe to be considered successful after having failed. Defaults to 1. Must be 1 for liveness. Minimum value is 1.
failureThreshold: When a Pod starts and the probe fails, Kubernetes will try failureThreshold times before giving up. Giving up in case of liveness probe means restarting the Pod. In case of readiness probe the Pod will be marked Unready. Defaults to 3. Minimum value is 1.

#+BEGIN_EXAMPLE
apiVersion: v1
kind: Pod
metadata:
  labels:
    test: liveness
  name: liveness-exec
spec:
  containers:
  - args:
    - /bin/sh
    - -c
    - echo ok > /tmp/health; sleep 10; rm -rf /tmp/health; sleep 600
    image: gcr.io/google_containers/busybox
    livenessProbe:
      exec:
        command:
        - cat
        - /tmp/health
      initialDelaySeconds: 15
      timeoutSeconds: 1
    name: liveness
#+END_EXAMPLE
** CANCELED k8s exec try to find bash, but I only have sh
   CLOSED: [2018-01-08 Mon 08:23]
** DONE list all critical pods
  CLOSED: [2018-01-04 Thu 10:10]
kubectl --namespace kube-system get pods

for pod in $(kubectl --namespace kube-system get pods -o jsonpath="{.items[*].metadata.name}"); do
    node_info=$(kubectl --namespace kube-system describe pod $pod | grep "Node:")
    echo "Pod: $pod, $node_info"
done
** DONE k8s cheatsheet: kube-shell https://github.com/cloudnativelabs/kube-shell
   CLOSED: [2017-12-31 Sun 10:47]
** DONE k8s configmap
  CLOSED: [2018-01-08 Mon 10:32]
https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/
| Name                                                | Summary |
|-----------------------------------------------------+---------|
| kubectl get configmaps my-wordpress-mariadb -o yaml |         |
** DONE [#A] k8s initContainers debug: kubectl logs <pod-name> -c <init-container-2>
  CLOSED: [2018-01-05 Fri 16:29]
https://kubernetes.io/docs/tasks/debug-application-cluster/debug-init-containers/
** DONE Use GCE to setup k8s cluster deployment
  CLOSED: [2018-01-07 Sun 07:26]
https://github.com/kelseyhightower/kubernetes-the-hard-way

https://cloud.google.com/
source /Users/mac/Downloads/google-cloud-sdk/completion.bash.inc
source /Users/mac/Downloads/google-cloud-sdk/path.bash.inc
*** doc: gcloud setup
#+BEGIN_EXAMPLE
   [28] us-central1-f
   [29] us-central1-c
   [30] us-central1-b
   [31] us-east1-d
   [32] us-east1-c
   [33] us-east1-b
   [34] us-east4-c
   [35] us-east4-a
   [36] us-east4-b
   [37] us-west1-a
   [38] us-west1-c
   [39] us-west1-b
   [40] Do not set default zone
  Please enter numeric choice or text value (must exactly match list
  item):  36

  Your project default Compute Engine zone has been set to [us-east4-b].
  You can change it by running [gcloud config set compute/zone NAME].

  Your project default Compute Engine region has been set to [us-east4].
  You can change it by running [gcloud config set compute/region NAME].

  Created a default .boto configuration file at [/Users/mac/.boto]. See this file and
  [https://cloud.google.com/storage/docs/gsutil/commands/config] for more
  information about configuring Google Cloud Storage.
  Your Google Cloud SDK is configured and ready to use!

  * Commands that require authentication will use denny.zhang001@gmail.com by default
  * Commands will reference project `denny-k8s-test1` by default
  * Compute Engine commands will use region `us-east4` by default
  * Compute Engine commands will use zone `us-east4-b` by default

  Run `gcloud help config` to learn how to change individual settings

  This gcloud configuration is called [default]. You can create additional configurations if you work with multiple accounts and/or projects.
  Run `gcloud topic configurations` to learn more.

  Some things to try next:

  * Run `gcloud --help` to see the Cloud Platform services you can interact with. And run `gcloud help COMMAND` to get help on any gcloud command.
  * Run `gcloud topic -h` to learn about advanced features of the SDK like arg files and output formatting
#+END_EXAMPLE
*** TODO [#A] can't find gcloud                                   :IMPORTANT:
source /Users/mac/Downloads/google-cloud-sdk/completion.bash.inc
source /Users/mac/Downloads/google-cloud-sdk/path.bash.inc
** DONE kubectl get pod
   CLOSED: [2018-04-28 Sat 09:28]
 /etc/kubernetes/admin.conf /etc/kubernetes/kubelet.conf /etc/kubernetes/bootstrap-kubelet.conf /etc/kubernetes/controller-manager.conf /etc/kubernetes/scheduler.conf]

 #+BEGIN_EXAMPLE
 Your Kubernetes master has initialized successfully!

 To start using your cluster, you need to run the following as a regular user:

   mkdir -p $HOME/.kube
   sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
   sudo chown $(id -u):$(id -g) $HOME/.kube/config

 You should now deploy a pod network to the cluster.
 Run "kubectl apply -f [podnetwork].yaml" with one of the options listed at:
   https://kubernetes.io/docs/concepts/cluster-administration/addons/
 #+END_EXAMPLE
** DONE pod CrashLoopBackOff: starting, then crashing, then starting again and crashing again.

   CLOSED: [2018-01-05 Fri 15:47]
 https://www.krenger.ch/blog/crashloopbackoff-and-how-to-fix-it/

 https://kubernetes.io/docs/tasks/debug-application-cluster/debug-init-containers/

 | Status                     | Meaning                                                     |
 |----------------------------+-------------------------------------------------------------|
 | Init:N/M                   | The Pod has M Init Containers, and N have completed so far. |
 | Init:Error                 | An Init Container has failed to execute.                    |
 | Init:CrashLoopBackOff      | An Init Container has failed repeatedly.                    |
 | Pending                    | The Pod has not yet begun executing Init Containers.        |
 | PodInitializing or Running | The Pod has already finished executing Init Containers.     |
** DONE k8s ImagePullBackOff: describe pod $pod_name; No space
   CLOSED: [2018-06-25 Mon 14:28]
** DONE default pods for single node installation
   CLOSED: [2018-04-28 Sat 08:49]
 #+BEGIN_EXAMPLE
 root@mdm-k8s-node2:~# docker ps
 CONTAINER ID        IMAGE                                                                                                              COMMAND                  CREATED             STATUS              PORTS               NAMES
 75d08dd2b171        k8s.gcr.io/kube-proxy-amd64@sha256:c7036a8796fd20c16cb3b1cef803a8e980598bff499084c29f3c759bdb429cd2                "/usr/local/bin/ku..."   16 hours ago        Up 16 hours                             k8s_kube-proxy_kube-proxy-jmcs9_kube-system_02a0eac8-4a75-11e8-afce-7aa5a78d07bd_0
 0a769558ec4f        k8s.gcr.io/pause-amd64:3.1                                                                                         "/pause"                 16 hours ago        Up 16 hours                             k8s_POD_kube-proxy-jmcs9_kube-system_02a0eac8-4a75-11e8-afce-7aa5a78d07bd_0
 2af1fbfd581a        k8s.gcr.io/kube-apiserver-amd64@sha256:1ba863c8e9b9edc6d1329ebf966e4aa308ca31b42a937b4430caf65aa11bdd12            "kube-apiserver --..."   16 hours ago        Up 16 hours                             k8s_kube-apiserver_kube-apiserver-mdm-k8s-node2_kube-system_fee65b809c1e455cf1672ebe7efc4bc7_0
 63c214ac8d1b        k8s.gcr.io/kube-controller-manager-amd64@sha256:922ac89166ea228cdeff43e4c445a5dc4204972cc0e265a8762beec07b6238bf   "kube-controller-m..."   16 hours ago        Up 16 hours                             k8s_kube-controller-manager_kube-controller-manager-mdm-k8s-node2_kube-system_5ad7a10c5a8589117db7258c7d499a33_0
 324ff1a8d357        k8s.gcr.io/kube-scheduler-amd64@sha256:5f50a339f66037f44223e2b4607a24888177da6203a7bc6c8554e0f09bd2b644            "kube-scheduler --..."   16 hours ago        Up 16 hours                             k8s_kube-scheduler_kube-scheduler-mdm-k8s-node2_kube-system_aa8d5cab3ea096315de0c2003230d4f9_0
 dce77d944669        k8s.gcr.io/etcd-amd64@sha256:68235934469f3bc58917bcf7018bf0d3b72129e6303b0bef28186d96b2259317                      "etcd --listen-cli..."   16 hours ago        Up 16 hours                             k8s_etcd_etcd-mdm-k8s-node2_kube-system_59f847fe34319ab1263f0b3ee03df8a3_0
 2af621e52e11        k8s.gcr.io/pause-amd64:3.1                                                                                         "/pause"                 16 hours ago        Up 16 hours                             k8s_POD_kube-apiserver-mdm-k8s-node2_kube-system_fee65b809c1e455cf1672ebe7efc4bc7_0
 bdc64588b27d        k8s.gcr.io/pause-amd64:3.1                                                                                         "/pause"                 16 hours ago        Up 16 hours                             k8s_POD_kube-controller-manager-mdm-k8s-node2_kube-system_5ad7a10c5a8589117db7258c7d499a33_0
 14dd26427abf        k8s.gcr.io/pause-amd64:3.1                                                                                         "/pause"                 16 hours ago        Up 16 hours                             k8s_POD_kube-scheduler-mdm-k8s-node2_kube-system_aa8d5cab3ea096315de0c2003230d4f9_0
 17bfbb8af205        k8s.gcr.io/pause-amd64:3.1                                                                                         "/pause"                 16 hours ago        Up 16 hours                             k8s_POD_etcd-mdm-k8s-node2_kube-system_59f847fe34319ab1263f0b3ee03df8a3_0
 #+END_EXAMPLE
** DONE One pod may have multiple containers
   CLOSED: [2018-06-19 Tue 14:31]
 If a pod has more than 1 containers then you need to provide the name of the specific container.
** DONE kubectl edit deployment parameters
   CLOSED: [2018-04-15 Sun 21:49]
 https://github.com/kubernetes/helm/issues/2464
 kubectl -n kube-system patch deployment tiller-deploy -p '{"spec": {"template": {"spec": {"automountServiceAccountToken": true}}}}'

 kubectl --namespace=kube-system edit deployment/tiller-deploy and changed automountServiceAccountToken to true.
** DONE [#A] k8s sidecar
   CLOSED: [2018-07-15 Sun 22:50]
 https://k8s.io/examples/admin/logging/two-files-counter-pod-streaming-sidecar.yaml
 #+BEGIN_EXAMPLE
 apiVersion: v1
 kind: Pod
 metadata:
   name: counter
 spec:
   containers:
   - name: count
     image: busybox
     args:
     - /bin/sh
     - -c
     - >
       i=0;
       while true;
       do
         echo "$i: $(date)" >> /var/log/1.log;
         echo "$(date) INFO $i" >> /var/log/2.log;
         i=$((i+1));
         sleep 1;
       done
     volumeMounts:
     - name: varlog
       mountPath: /var/log
   - name: count-log-1
     image: busybox
     args: [/bin/sh, -c, 'tail -n+1 -f /var/log/1.log']
     volumeMounts:
     - name: varlog
       mountPath: /var/log
   - name: count-log-2
     image: busybox
     args: [/bin/sh, -c, 'tail -n+1 -f /var/log/2.log']
     volumeMounts:
     - name: varlog
       mountPath: /var/log
   volumes:
   - name: varlog
     emptyDir: {}
 #+END_EXAMPLE
* [#A] minikube
https://github.com/kubernetes/minikube
https://github.com/DennyZhang/cheatsheet-kubernetes-A4
** install minikube
https://github.com/kubernetes/minikube

brew cask install minikube
** DONE minikube volume local drive
   CLOSED: [2018-07-15 Sun 22:46]
 https://stackoverflow.com/questions/42456159/minikube-volumes

 #+BEGIN_EXAMPLE
 /data
 /var/lib/localkube
 /var/lib/docker
 #+END_EXAMPLE

ls -lth /var/lib/kubelet/pods/f2f8f500-88ba-11e8-89ad-080027cbaea4/volumes/kubernetes.io~empty-dir/varlog/1.log
* #  --8<-------------------------- separator ------------------------>8-- :noexport:
* [#A] kubernetes/helm: The Kubernetes Package Manager
| Name    | Summary                                                                  |
|---------+--------------------------------------------------------------------------|
| Helm    | a chart manager.                                                         |
| Charts  | packages of pre-configured Kubernetes resources.                         |
| Release | a collection of Kubernetes resources deployed to the cluster using Helm. |
| tiller  | helm server manages releases (installations) of your charts.             |

| Name                                           | Summary |
|------------------------------------------------+---------|
| helm init                                      |         |
| helm list                                      |         |
| helm list -a                                   |         |
| helm repo update                               |         |
| helm install stable/mysql                      |         |
| helm install --name mysql-release stable/mysql |         |
| helm inspect stable/mysql                      |         |
| helm status $helm_name                         |         |
| helm delete $helm_name                         |         |
| helm delete --purge $helm_name                 |         |
|------------------------------------------------+---------|
| ~/.helm/cache/archive                          |         |

Release, list, inspect, delete, rollback, purge
** useful link
https://github.com/kubernetes/helm
https://hub.kubeapps.com/
https://daemonza.github.io/2017/02/20/using-helm-to-deploy-to-kubernetes/
https://www.mirantis.com/blog/install-kubernetes-apps-helm/
** DONE Use helm to install mysql
   CLOSED: [2018-01-05 Fri 13:09]
https://github.com/kubernetes/charts/tree/master/stable/mysql
*** helm inspect stable/mysql
#+BEGIN_EXAMPLE
ubuntu@k8s1:~$ helm inspect stable/mysql
description: Fast, reliable, scalable, and easy to use open-source relational database
  system.
engine: gotpl
home: https://www.mysql.com/
icon: https://www.mysql.com/common/logos/logo-mysql-170x115.png
keywords:
- mysql
- database
- sql
maintainers:
- email: viglesias@google.com
  name: Vic Iglesias
name: mysql
sources:
- https://github.com/kubernetes/charts
- https://github.com/docker-library/mysql
version: 0.3.2

---
## mysql image version
## ref: https://hub.docker.com/r/library/mysql/tags/
##
image: "mysql"
imageTag: "5.7.14"

## Specify password for root user
##
## Default: random 10 character string
# mysqlRootPassword: testing

## Create a database user
##
# mysqlUser:
# mysqlPassword:

## Allow unauthenticated access, uncomment to enable
##
# mysqlAllowEmptyPassword: true

## Create a database
##
# mysqlDatabase:

## Specify an imagePullPolicy (Required)
## It's recommended to change this to 'Always' if the image tag is 'latest'
## ref: http://kubernetes.io/docs/user-guide/images/#updating-images
##
imagePullPolicy: IfNotPresent

livenessProbe:
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  successThreshold: 1
  failureThreshold: 3

readinessProbe:
  initialDelaySeconds: 5
  periodSeconds: 10
  timeoutSeconds: 1
  successThreshold: 1
  failureThreshold: 3

## Persist data to a persistent volume
persistence:
  enabled: true
  ## database data Persistent Volume Storage Class
  ## If defined, storageClassName: <storageClass>
  ## If set to "-", storageClassName: "", which disables dynamic provisioning
  ## If undefined (the default) or set to null, no storageClassName spec is
  ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
  ##   GKE, AWS & OpenStack)
  ##
  # storageClass: "-"
  accessMode: ReadWriteOnce
  size: 8Gi

## Configure resource requests and limits
## ref: http://kubernetes.io/docs/user-guide/compute-resources/
##
resources:
  requests:
    memory: 256Mi
    cpu: 100m

# Custom mysql configuration files used to override default mysql settings
configurationFiles:
#  mysql.cnf: |-
#    [mysqld]
#    skip-name-resolve
#+END_EXAMPLE
*** helm install stable/mysql
#+BEGIN_EXAMPLE
ubuntu@k8s1:~$ helm install stable/mysql
NAME:   joyous-grizzly
LAST DEPLOYED: Sun Dec 31 14:28:07 2017
NAMESPACE: default
STATUS: DEPLOYED

RESOURCES:
==> v1/Secret
NAME                  TYPE    DATA  AGE
joyous-grizzly-mysql  Opaque  2     0s

==> v1/PersistentVolumeClaim
NAME                  STATUS   VOLUME  CAPACITY  ACCESS MODES  STORAGECLASS  AGE
joyous-grizzly-mysql  Pending  0s

==> v1/Service
NAME                  TYPE       CLUSTER-IP      EXTERNAL-IP  PORT(S)   AGE
joyous-grizzly-mysql  ClusterIP  10.100.217.119  <none>       3306/TCP  0s

==> v1beta1/Deployment
NAME                  DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE
joyous-grizzly-mysql  1        1        1           0          0s

==> v1/Pod(related)
NAME                                  READY  STATUS   RESTARTS  AGE
joyous-grizzly-mysql-8bb45c5bf-b4kqv  0/1    Pending  0         0s


NOTES:
MySQL can be accessed via port 3306 on the following DNS name from within your cluster:
joyous-grizzly-mysql.default.svc.cluster.local

To get your root password run:

    kubectl get secret --namespace default joyous-grizzly-mysql -o jsonpath="{.data.mysql-root-password}" | base64 --decode; echo

To connect to your database:

1. Run an Ubuntu pod that you can use as a client:

    kubectl run -i --tty ubuntu --image=ubuntu:16.04 --restart=Never -- bash -il

2. Install the mysql client:

    $ apt-get update && apt-get install mysql-client -y

3. Connect using the mysql cli, then provide your password:
    $ mysql -h joyous-grizzly-mysql -p
#+END_EXAMPLE
*** DONE no available release name found
   CLOSED: [2017-12-31 Sun 08:50]
https://github.com/kubernetes/helm/issues/3055
** BYPASS [#A] helm install Error: no available release name found
   CLOSED: [2018-01-05 Fri 13:09]
https://github.com/kubernetes/helm/issues/3055
https://stackoverflow.com/questions/43499971/helm-error-no-available-release-name-found
https://github.com/kubernetes/helm/issues/2224

disable RBAC, then it works

kubectl create clusterrolebinding permissive-binding --clusterrole=cluster-admin --user=admin --user=kubelet --group=system:serviceaccounts

#+BEGIN_EXAMPLE
ubuntu@k8s1:~$ helm install stable/mysql
Error: no available release name found
#+END_EXAMPLE
** DONE Create persisitvolume first, before trying helm
   CLOSED: [2017-12-31 Sun 11:14]
sudo mkdir -p /data
sudo chmod 777 /data

cat > pv.yaml <<EOF
kind: PersistentVolume
apiVersion: v1
metadata:
  name: mydata
  labels:
    type: local
spec:
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/data/mydata"
EOF

kubectl apply -f ./pv.yaml
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** HALF ubuntu install helm
https://github.com/kubernetes/helm/releases/tag/v2.9.1
https://docs.helm.sh/using_helm/#quickstart-guide

- Download binary
- helm init
** HALF helm list: Error: could not find a ready tiller pod: kubectl get pods --all-namespaces
#+BEGIN_EXAMPLE
denny@mdm-k8s-node2:/root$ kubectl get pods --all-namespaces
NAMESPACE     NAME                                    READY     STATUS    RESTARTS   AGE
kube-system   etcd-mdm-k8s-node2                      1/1       Running   0          3m
kube-system   kube-apiserver-mdm-k8s-node2            1/1       Running   0          3m
kube-system   kube-controller-manager-mdm-k8s-node2   1/1       Running   0          3m
kube-system   kube-dns-86f4d74b45-rf5rj               0/3       Pending   0          4m
kube-system   kube-proxy-czcs5                        1/1       Running   0          4m
kube-system   kube-scheduler-mdm-k8s-node2            1/1       Running   0          3m
kube-system   tiller-deploy-df4fdf55d-zxdq4           0/1       Pending   0          1m
#+END_EXAMPLE
** DONE helm: Error: could not find a ready tiller pod
   CLOSED: [2018-04-15 Sun 21:50]
 https://github.com/kubernetes/helm/issues/2064
 kubectl -n kube-system get po

 kubectl --namespace kube-system describe pod tiller-deploy-6d5c5f8457-6w22m
** DONE helm list error
   CLOSED: [2018-04-15 Sun 21:50]
 https://github.com/kubernetes/helm/issues/2464

 I meet the same problem, it was due to KUBECONFIG is not default. so you shoud specify KUBECONFIG env to the right position.

 Denny-Laptop:~ DennyZhang$ helm list
 Error: Get http://localhost:8080/api/v1/namespaces/kube-system/configmaps?labelSelector=OWNER%!D(MISSING)TILLER: dial tcp 127.0.0.1:8080: connect: connection refused

 #+BEGIN_EXAMPLE
 @mattus Thanks a lot, i was stuck for ~ 3 days with this at work trying to deploy a k8s cluster. This should really be documented somewhere.
 What i did to solve the issue was:

 kubectl --namespace=kube-system edit deployment/tiller-deploy and changed automountServiceAccountToken to true.
 Then 'helm list' was giving me:
 Error: configmaps is forbidden: User "system:serviceaccount:kube-system:default" cannot list configmaps in the namespace "kube-system"
 That was fixed with solution from #2687:
 kubectl --namespace=kube-system create clusterrolebinding add-on-cluster-admin --clusterrole=cluster-admin --serviceaccount=kube-system:default
 #+END_EXAMPLE
** DONE helm start with env configured: helm install --set Master.ServiceType=NodePort stable/jenkins
   CLOSED: [2018-04-15 Sun 21:50]
* [#A] CRD: challenges-k8s-crd
* [#A] istio: challenges-k8s-istio
* #  --8<-------------------------- separator ------------------------>8-- :noexport:
* [#A] k8s metric server                                     :IMPORTANT:
Metrics Server is a cluster-wide aggregator of resource usage data. 

Metrics Server registered in the main API server through Kubernetes aggregator.

https://github.com/kubernetes-incubator/metrics-server
https://github.com/kubernetes-incubator/metrics-server/tree/master/deploy/1.8%2B

https://kubernetes.io/docs/tasks/debug-application-cluster/core-metrics-pipeline/
| Name           | Summary                                                           |
|----------------+-------------------------------------------------------------------|
| Core metrics   | node/container level metrics; CPU, memory, disk and network, etc. |
| Custom metrics | refers to application metrics, e.g. HTTP request rate.            |

Today (Kubernetes 1.7), there are several sources of metrics within a Kubernetes cluster
| Name           | Summary                                                             |
|----------------+---------------------------------------------------------------------|
| Heapster       | k8s add-on                                                          |
| Cadvisor       | a standalone container/node metrics collection and monitoring tool. |
| Kubernetes API | does not track metrics. But can get real time metrics               |

** metric server
Resource Metrics API is an effort to provide a first-class Kubernetes API (stable, versioned, discoverable, available through apiserver and with client support) that serves resource usage metrics for pods and nodes.

- metric server is sort of a stripped-down version of Heapster
- The metrics-server will collect “Core” metrics from cAdvisor APIs (currently embedded in the kubelet) and store them in memory as opposed to in etcd. 
- The metrics-server will provide a supported API for feeding schedulers and horizontal pod auto-scalers
- All other Kubernetes components will supply their own metrics in a Prometheus format
** Cadvisor
Cadvisor monitors node and container core metrics in addition to container events.
It natively provides a Prometheus metrics endpoint
The Kubernetes kublet has an embedded Cadvisor that only exposes the metrics, not the events.
** heapster
Heapster is an add on to Kubernetes that collects and forwards both node, namespace, pod and container level metrics to one or more “sinks” (e.g. InfluxDB). 

It also provides REST endpoints to gather those metrics. The metrics are constrained to CPU, filesystem, memory, network and uptime.

Heapster queries the kubelet for its data.

Today, heapster is the source of the time-series data for the Kubernetes Dashboard.
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO How to query metric server
** TODO Key scenarios of metric server
The metrics-server will provide a much needed official API for the internal components of Kubernetes to make decisions about the utilization and performance of the cluster.

- HPA(Horizontal Pod Autoscaler) need input to do good auto-scaling
** TODO There are plans for an “Infrastore”, a Kubernetes component that keeps historical data and events
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO why from heapster to k8s metric server?
** TODO kube-aggregator
** TODO what is promethues format?
#+BEGIN_EXAMPLE
Denny Zhang [12:34 AM]
An easy introduction about k8s metric server. (It will replace heapster)

https://blog.freshtracks.io/what-is-the-the-new-kubernetes-metrics-server-849c16aa01f4

> All other Kubernetes components will supply their own metrics in a Prometheus format

In logging domain, we can say `syslog` is the standard format

In metric domain, maybe we can choose `prometheus` as the standard format.
#+END_EXAMPLE
** try metric server in minikube
https://docs.giantswarm.io/guides/kubernetes-heapster/

http://192.168.99.102:30000/metrics
** Metrics Use Cases
https://github.com/kubernetes/community/blob/master/contributors/design-proposals/instrumentation/resource-metrics-api.md

https://docs.giantswarm.io/guides/kubernetes-heapster/

#+BEGIN_EXAMPLE
Horizontal Pod Autoscaler: It scales pods automatically based on CPU or custom metrics (not explained here). More information here.
Kubectl top: The command top of our beloved Kubernetes CLI display metrics directly in the terminal.
Kubernetes dashboard: See Pod and Nodes metrics integrated into the main Kubernetes UI dashboard. More info here
Scheduler: In the future Core Metrics will be considered in order to schedule best-effort Pods.
#+END_EXAMPLE
** useful link
https://blog.freshtracks.io/what-is-the-the-new-kubernetes-metrics-server-849c16aa01f4
https://blog.outlyer.com/monitoring-kubernetes-with-heapster-and-prometheus
https://www.outcoldman.com/en/archive/2017/07/09/kubernetes-monitoring-resources/
* Kubernetes Monitoring: prometheus, heapster
https://deis.com/blog/2016/monitoring-kubernetes-with-heapster/
https://groups.google.com/forum/#!topic/prometheus-developers/3zq4oD7if3s

Since we're extending heapster in various ways for auto-scaling, and
we're about to add support for collecting and aggregating custom
metrics, we should decide and document what the boundaries for
heapster's responsibilities should be. In particular, I don't want it
to grow into a general-purpose application and/or infrastructure
monitoring, dashboarding, and alerting system, such as
Prometheus. There are many such systems, and we shouldn't compete with
them.

#+BEGIN_EXAMPLE
Heapster is a competing monitoring system.

 * Heapster is limited to Kuberenetes container metrics, it is not general use.
 * Heapster only provides metrics back as REST, it does not have a query language. (atleast that I could find)
 * Heapster does not have any form of alerting.
Basically, if you have Prometheus, there's almost no reason to use heapster.
#+END_EXAMPLE
** What is the relationship of heapster and prometheus
https://groups.google.com/forum/#!topic/prometheus-developers/3zq4oD7if3s
https://github.com/kubernetes/heapster/issues/665
* k8s Logging
https://kubernetes.io/docs/concepts/cluster-administration/logging/
https://kubernetes.io/blog/2015/06/cluster-level-logging-with-kubernetes/
https://github.com/kubernetes/kubernetes/tree/release-1.0/contrib/logging
** DONE kubectl logs: Error from server (BadRequest): a container name must be specified for pod ...
   CLOSED: [2018-07-23 Mon 14:44]
* k8s go client
** events
https://github.com/kubernetes/client-go/blob/master/listers/core/v1/event.go
** TODO Client-go does not use a Swagger generator. Instead, it uses source code generators
source code generators are originated from the Kubernetes project, to create Kubernetes-style API objects and serializers.

https://medium.com/programming-kubernetes/building-stuff-with-the-kubernetes-api-part-4-using-go-b1d0e3c1c899
** sample: subscribe to events
#+BEGIN_SRC go
    ch := watcher.ResultChan()

    fmt.Printf("--- PVC Watch (max claims %v) ----\n", maxClaimedQuant.String())
    for event := range ch {
	pvc, ok := event.Object.(*v1.PersistentVolumeClaim)
	if !ok {
		log.Fatal("unexpected type")
	}
	quant := pvc.Spec.Resources.Requests[v1.ResourceStorage]

	switch event.Type {
	case watch.Added:
		totalClaimedQuant.Add(quant)
		log.Printf("PVC %s added, claim size %s\n", pvc.Name, quant.String())

		// is claim overage?
		if totalClaimedQuant.Cmp(maxClaimedQuant) == 1 {
			log.Printf("\nClaim overage reached: max %s at %s",
				maxClaimedQuant.String(),
				totalClaimedQuant.String(),
			)
			// trigger action
			log.Println("*** Taking action ***")
		}

	case watch.Modified:
		//log.Printf("Pod %s modified\n", pod.GetName())
	case watch.Deleted:
		quant := pvc.Spec.Resources.Requests[v1.ResourceStorage]
		totalClaimedQuant.Sub(quant)
#+END_SRC

https://github.com/vladimirvivien/k8s-client-examples/blob/master/go/pvcwatch/main.go
* #  --8<-------------------------- separator ------------------------>8-- :noexport:
* k8s loadbalancer
** DONE k8s service: loadbalancer
   CLOSED: [2018-06-19 Tue 13:51]
 #+BEGIN_EXAMPLE
 cat > service.yml <<EOF
 apiVersion: v1
 kind: Service
 metadata:
   name: lb
   namespace: logging
 spec:
   selector:
     app: kibana
   ports:
   - protocol: TCP
     port: 5601
   type: LoadBalancer
 EOF
 #+END_EXAMPLE
* k8s scheduling
** Tell k8s your estimation for resource usage(CPU/RAM) per Pod
https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/

https://kubernetes.io/docs/concepts/policy/resource-quotas/#requests-vs-limits

#+BEGIN_EXAMPLE
Each Container of a Pod can specify one or more of the following:

spec.containers[].resources.limits.cpu
spec.containers[].resources.limits.memory
spec.containers[].resources.requests.cpu
spec.containers[].resources.requests.memory
#+END_EXAMPLE

#+BEGIN_EXAMPLE
apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
  - name: db
    image: mysql
    env:
    - name: MYSQL_ROOT_PASSWORD
      value: "password"
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
  - name: wp
    image: wordpress
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
#+END_EXAMPLE
* k8s DaemonSet
** DONE k8s daemonsets: ensures that all (or some) Nodes run a copy of a Pod.
   CLOSED: [2018-06-19 Tue 13:28]
 https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/

 As nodes are added to the cluster, Pods are added to them. As nodes are removed from the cluster, those Pods are garbage collected. Deleting a DaemonSet will clean up the Pods it created.

 Some typical uses of a DaemonSet are:

 - running a cluster storage daemon, such as glusterd, ceph, on each node.
 - running a logs collection daemon on every node, such as fluentd or logstash.
   - running a node monitoring daemon on every node, such as Prometheus Node Exporter, collectd, Datadog agent, New Relic agent, or Ganglia gmond.
* [#A] etcd
https://coreos.com/etcd/docs/latest/dev-guide/interacting_v3.html
https://coreos.com/etcd/docs/latest/v2/README.html
* [#B] k8s addons
https://kubernetes.io/docs/concepts/cluster-administration/addons/
** DONE k8s install add-on: dashboard
  CLOSED: [2018-01-03 Wed 12:19]
- Install, then use kubectl-proxy to start
- Create user and binding, then use token to login

#+BEGIN_EXAMPLE
kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml
nohup kubectl proxy --port=8001 --address=0.0.0.0 &

curl http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/

#+END_EXAMPLE

#+BEGIN_EXAMPLE
# https://github.com/kubernetes/dashboard/wiki/Creating-sample-user
cat > user.yaml <<EOF
apiVersion: v1
kind: ServiceAccount
metadata:
  name: admin-user
  namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: admin-user
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: admin-user
  namespace: kube-system
EOF
#+END_EXAMPLE

kubectl apply -f user.yaml
kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk '{print $1}')

https://github.com/kubernetes/dashboard#kubernetes-dashboard
https://blog.frognew.com/2017/09/kubeadm-install-kubernetes-1.8.html#8dashboard%E6%8F%92%E4%BB%B6%E9%83%A8%E7%BD%B2
*** DONE kubectl proxy listen on all network nics
  CLOSED: [2018-01-03 Wed 12:12]
https://github.com/kubernetes/kubectl/issues/142
kubectl proxy --port=8001 --address=0.0.0.0
* [#A] k8s volumes
  CLOSED: [2017-12-01 Fri 22:45]
https://kubernetes.io/docs/concepts/storage/volumes
https://kubernetes.io/docs/tasks/configure-pod-container/configure-volume-storage/
https://kubernetes.io/docs/concepts/storage/persistent-volumes/#claims-as-volumes

https://blog.couchbase.com/stateful-containers-kubernetes-amazon-ebs/
https://stackoverflow.com/questions/37555281/create-kubernetes-pod-with-volume-using-kubectl-run
https://kubernetes.io/docs/tasks/configure-pod-container/configure-volume-storage/

▪Directory accessible to the containers in a pod
▪Volume outlives any containers in a pod
▪Common types
   hostPath
   nfs
   awsElasticBlockStore
   gcePersistentDisk

#+BEGIN_EXAMPLE
Creating and using a persistent volume is a three step process:
1. Provision: Administrator provision a networked storage in the cluster, such as AWS ElasticBlockStore volumes. This is called as PersistentVolume.
2. Request storage: User requests storage for pods by using claims. Claims can specify levels of resources (CPU and memory), specific sizes and access modes (e.g. can be mounted once read/write or many times write only).
This is called as PersistentVolumeClaim.
1. Use claim: Claims are mounted as volumes and used in pods for storage.
#+END_EXAMPLE
** DONE persistence.accessMode ReadWriteOnce or ReadOnly: https://github.com/kubernetes/charts/tree/master/stable/mysql
  CLOSED: [2018-01-02 Tue 16:52]
The access modes are:

ReadWriteOnce – the volume can be mounted as read-write by a single node
ReadOnlyMany – the volume can be mounted read-only by many nodes
ReadWriteMany – the volume can be mounted as read-write by many nodes
* [#A] kubeadm: performs the actions necessary to get a minimum viable cluster up and running
https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/

kubeadm init and kubeadm join together provides a nice user experience
for creating a best-practice but bare Kubernetes cluster from scratch.

| Name            | Summary                                                                                                      |
|-----------------+--------------------------------------------------------------------------------------------------------------|
| kubeadm init    | bootstrap a Kubernetes master node                                                                           |
| kubeadm join    | bootstrap a Kubernetes worker node and join it to the cluster                                                |
| kubeadm upgrade | upgrade a Kubernetes cluster to a newer version                                                              |
| kubeadm config  | if you initialized your cluster using kubeadm v1.7.x or lower, to configure your cluster for kubeadm upgrade |
| kubeadm token   | manage tokens for kubeadm join                                                                               |
| kubeadm reset   | revert any changes made to this host by kubeadm init or kubeadm join                                         |

This process works with local VMs, physical servers and/or cloud servers.
** DONE kubeadm: recreate a node
  CLOSED: [2018-01-03 Wed 16:18]
https://stackoverflow.com/questions/45913034/readd-a-deleted-node-to-kubernetes

https://kubernetes.io/docs/tasks/administer-cluster/safely-drain-node/
#+BEGIN_EXAMPLE
kubeadm: run kubeadm reset and kubeadm join ... again on the node (you might need to create a new token if the original one was short-lived, see the linked doc)
most clouds: delete the VM. It will be recreated and will rejoin the cluster
others: see self registration and manual registration for details.
#+END_EXAMPLE
** TODO kubeadm join token issue: How to caculate --discovery-token-ca-cert-hash
https://stackoverflow.com/questions/47770486/kubeadm-init-token-xyz-or-kubeadm-init-token-xyz

kubeadm token  list

how to get --discovery-token-ca-cert-hash

#+BEGIN_EXAMPLE
root@k8s1:~# kubeadm init --token 2f1a31.00f66dec74fd53f3 --apiserver-advertise-address=172.42.42.1
[init] Using Kubernetes version: v1.9.0
[init] Using Authorization modes: [Node RBAC]
[preflight] Running pre-flight checks.
	[WARNING FileExisting-crictl]: crictl not found in system path
[preflight] Starting the kubelet service
[certificates] Generated ca certificate and key.
[certificates] Generated apiserver certificate and key.
[certificates] apiserver serving cert is signed for DNS names [k8s1 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 172.42.42.1]
[certificates] Generated apiserver-kubelet-client certificate and key.
[certificates] Generated sa key and public key.
[certificates] Generated front-proxy-ca certificate and key.
[certificates] Generated front-proxy-client certificate and key.
[certificates] Valid certificates and keys now exist in "/etc/kubernetes/pki"
[kubeconfig] Wrote KubeConfig file to disk: "admin.conf"
[kubeconfig] Wrote KubeConfig file to disk: "kubelet.conf"
[kubeconfig] Wrote KubeConfig file to disk: "controller-manager.conf"
[kubeconfig] Wrote KubeConfig file to disk: "scheduler.conf"
[controlplane] Wrote Static Pod manifest for component kube-apiserver to "/etc/kubernetes/manifests/kube-apiserver.yaml"
[controlplane] Wrote Static Pod manifest for component kube-controller-manager to "/etc/kubernetes/manifests/kube-controller-manager.yaml"
[controlplane] Wrote Static Pod manifest for component kube-scheduler to "/etc/kubernetes/manifests/kube-scheduler.yaml"
[etcd] Wrote Static Pod manifest for a local etcd instance to "/etc/kubernetes/manifests/etcd.yaml"
[init] Waiting for the kubelet to boot up the control plane as Static Pods from directory "/etc/kubernetes/manifests".
[init] This might take a minute or longer if the control plane images have to be pulled.
[apiclient] All control plane components are healthy after 25.502909 seconds
[uploadconfig] Storing the configuration used in ConfigMap "kubeadm-config" in the "kube-system" Namespace
[markmaster] Will mark node k8s1 as master by adding a label and a taint
[markmaster] Master k8s1 tainted and labelled with key/value: node-role.kubernetes.io/master=""
[bootstraptoken] Using token: 2f1a31.00f66dec74fd53f3
[bootstraptoken] Configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials
[bootstraptoken] Configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token
[bootstraptoken] Configured RBAC rules to allow certificate rotation for all node client certificates in the cluster
[bootstraptoken] Creating the "cluster-info" ConfigMap in the "kube-public" namespace
[addons] Applied essential addon: kube-dns
[addons] Applied essential addon: kube-proxy

Your Kubernetes master has initialized successfully!

To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME/.kube
  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
  sudo chown $(id -u):$(id -g) $HOME/.kube/config

You should now deploy a pod network to the cluster.
Run "kubectl apply -f [podnetwork].yaml" with one of the options listed at:
  https://kubernetes.io/docs/concepts/cluster-administration/addons/

You can now join any number of machines by running the following on each node
as root:

  kubeadm join --token 2f1a31.00f66dec74fd53f3 172.42.42.1:6443 --discovery-token-ca-cert-hash sha256:26ba6d67cbffbe67a7b77748ffa1d76bab74ff546de5a9e2af930e5a1272d188
#+END_EXAMPLE

#+BEGIN_EXAMPLE
root@k8s1:/var/log# kubeadm reset
[preflight] Running pre-flight checks.
[reset] Stopping the kubelet service.
[reset] Unmounting mounted directories in "/var/lib/kubelet"
[reset] Removing kubernetes-managed containers.
[reset] Deleting contents of stateful directories: [/var/lib/kubelet /etc/cni/net.d /var/lib/dockershim /var/run/kubernetes /var/lib/etcd]
[reset] Deleting contents of config directories: [/etc/kubernetes/manifests /etc/kubernetes/pki]
[reset] Deleting files: [/etc/kubernetes/admin.conf /etc/kubernetes/kubelet.conf /etc/kubernetes/controller-manager.conf /etc/kubernetes/scheduler.conf]
#+END_EXAMPLE
** useful link
https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/
https://medium.com/@SystemMining/setup-kubenetes-cluster-on-ubuntu-16-04-with-kubeadm-336f4061d929
https://marc.xn--wckerlin-0za.ch/computer/kubernetes-on-ubuntu-16-04

https://github.com/kubernetes/kubeadm/blob/master/docs/design/design_v1.8.md
https://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#24-initializing-your-master
* [#B] k8s security: secrets, authentication & authorization
** what's service account: In contrast, service accounts are users managed by the Kubernetes API.
https://kubernetes.io/docs/admin/authentication/
https://github.com/kubernetes/kubernetes/blob/master/examples/elasticsearch/service-account.yaml
https://kubernetes.io/docs/admin/authorization/
** serviceaccount, clusterrolebinding
https://blog.frognew.com/2017/12/its-time-to-use-helm.html
#+BEGIN_EXAMPLE
apiVersion: v1
kind: ServiceAccount
metadata:
  name: tiller
  namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: tiller
    namespace: kube-system
#+END_EXAMPLE
** web page: Creating sample user · kubernetes/dashboard Wiki · GitHub
https://github.com/kubernetes/dashboard/wiki/Creating-sample-user
*** webcontent                                                     :noexport:
#+begin_example
Location: https://github.com/kubernetes/dashboard/wiki/Creating-sample-user
Skip to content
The vote is over, but the fight for net neutrality isn’t. Show your support for a free and open
internet.
Learn more Dismiss

  * Features
  * Business
  * Explore
  * Marketplace
  * Pricing

This repository [                    ]
Sign in or Sign up

  * Watch 120
  * Star 1,839
  * Fork 586

kubernetes/dashboard

Code Issues 95 Pull requests 8 Projects 0 Wiki Insights

Creating sample user

Sebastian Florek edited this page Dec 14, 2017 · 6 revisions

Pages 21

[                    ]

  * Home
  * Access control
  * Accessing Dashboard
  * Accessing Dashboard 1.6.X and below
  * Accessing Dashboard 1.7.X and above
  * Architecture
  * Certificate management
  * Code conventions
  * Compatibility matrix
  * Creating sample user
  * Dashboard arguments
  * Dependency management
  * FAQ
  * Getting started
  * Installation
  * Integrations
  * Internationalization
  * Labels
  * Release procedures
  * Roadmap
  * Text conventions
  * Show 6 more pages…

 Home

 Common

  * FAQ
  * Compatibility matrix
  * Roadmap
  * Dashboard arguments

 User Guide

  * Installation
  * Certificate management
  * Accessing Dashboard
      + 1.7.X and above
      + 1.6.X and below
  * Access control
      + Creating sample user
  * Integrations
  * Labels

 Development Guide

  * Getting started
  * Release procedures
  * Dependency management
  * Architecture
  * Code conventions
  * Text conventions
  * Internationalization

Clone this wiki locally

[https://github.com/k]

In this guide, we will find out how to create a new user using Service Account mechanism of
Kubernetes, grant this user admin permissions and log in to Dashboard using bearer token tied to
this user.

Copy provided snippets to some xxx.yaml file and use kubectl create -f xxx.yaml to create them.

 Create Service Account

We are creating Service Account with name admin-user in namespace kube-system first.

apiVersion: v1
kind: ServiceAccount
metadata:
  name: admin-user
  namespace: kube-system

 Create ClusterRoleBinding

In most cases after provisioning our cluster using kops or kubeadm or any other popular tool admin
Role already exists in the cluster. We can use it and create only RoleBinding for our
ServiceAccount.

NOTE: apiVersion of ClusterRoleBinding resource may differ between Kubernetes versions. Starting
from v1.8 it was promoted to rbac.authorization.k8s.io/v1.

apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRoleBinding
metadata:
  name: admin-user
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: admin-user
  namespace: kube-system

 Bearer Token

Now we need to find token we can use to log in. Execute following command:

kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk '{print $1}')

It should print something like:

Name:         admin-user-token-6gl6l
Namespace:    kube-system
Labels:       <none>
Annotations:  kubernetes.io/service-account.name=admin-user
              kubernetes.io/service-account.uid=b16afba9-dfec-11e7-bbb9-901b0e532516

Type:  kubernetes.io/service-account-token

Data
====
ca.crt:     1025 bytes
namespace:  11 bytes
token:      eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLTZnbDZsIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiJiMTZhZmJhOS1kZmVjLTExZTctYmJiOS05MDFiMGU1MzI1MTYiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06YWRtaW4tdXNlciJ9.M70CU3lbu3PP4OjhFms8PVL5pQKj-jj4RNSLA4YmQfTXpPUuxqXjiTf094_Rzr0fgN_IVX6gC4fiNUL5ynx9KU-lkPfk0HnX8scxfJNzypL039mpGt0bbe1IXKSIRaq_9VW59Xz-yBUhycYcKPO9RM2Qa1Ax29nqNVko4vLn1_1wPqJ6XSq3GYI8anTzV8Fku4jasUwjrws6Cn6_sPEGmL54sq5R4Z5afUtv-mItTmqZZdxnkRqcJLlg2Y8WbCPogErbsaCDJoABQ7ppaqHetwfM_0yMun6ABOQbIwwl8pspJhpplKwyo700OSpvTT9zlBsu-b35lzXGBRHzv5g_RA

Now copy the token and paste it into Enter token field on log in screen. zrzut ekranu z 2017-12-14
10-58-28

Click Sign in button and that's it. You are now logged in as an admin.

zrzut ekranu z 2017-12-14 10-59-31

In order to find out more about how to grant/deny permissions in Kubernetes read official
authentication & authorization documentation.

Copyright 2017 The Kubernetes Authors

  * © 2018 GitHub, Inc.
  * Terms
  * Privacy
  * Security
  * Status
  * Help

  * Contact GitHub
  * API
  * Training
  * Shop
  * Blog
  * About

You can't perform that action at this time.
You signed in with another tab or window. Reload to refresh your session. You signed out in another
tab or window. Reload to refresh your session.

#+end_example
** k8s secrets: intended to hold sensitive information, such as passwords, OAuth tokens, and ssh keys.
https://github.com/arun-gupta/vault-kubernetes/blob/master/secrets.yaml
http://kubernetesbyexample.com/secrets/

- Secrets are namespaced objects, that is, exist in the context of a namespace
- You can access them via a volume or an environment variable from a container running in a pod
- The secret data on nodes is stored in tmpfs volumes

kubectl create secret generic mysecret --from-literal=mysql_root_password=my-secret-pw
kubectl get secret mysecret

#+BEGIN_EXAMPLE
apiVersion: v1
kind: Pod
metadata:
  name: secret-env-pod
spec:
  containers:
  - name: mycontainer
    image: redis
    env:
      - name: SECRET_USERNAME
        valueFrom:
          secretKeyRef:
            name: mysecret
            key: username
      - name: SECRET_PASSWORD
        valueFrom:
          secretKeyRef:
            name: mysecret
            key: password
  restartPolicy: Never
#+END_EXAMPLE
* [#B] kubectl jsonpath support
https://kubernetes.io/docs/reference/kubectl/jsonpath/

kubectl get pods -o json
$ kubectl get pods -o=jsonpath='{@}'
$ kubectl get pods -o=jsonpath='{.items[0]}'
$ kubectl get pods -o=jsonpath='{.items[0].metadata.name}'
$ kubectl get pods -o=jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.status.startTime}{"\n"}{end}'

kubectl get pods -o=jsonpath='{.items[0].metadata.name}'

kubectl get pods -n oratos -o=jsonpath='{range .items[*]}{.metadata.name}:{.spec.containers[0].name}{"\t"}{.spec.containers[0].image}{"\n"}{end}'
* #  --8<-------------------------- separator ------------------------>8-- :noexport:
* TODO [#A] k8s debug why termination takes time
* TODO Kubernets availablity
** TODO Building High-Availability Clusters: https://kubernetes.io/docs/admin/high-availability/
* TODO [#A] Blog: Kubernetes Service Type: NodePort, ClusterIP and Loadbalancer?
#+BEGIN_EXAMPLE
https://kubernetes.io/docs/concepts/services-networking/service/

Publishing services - service types
For some parts of your application (e.g. frontends) you may want to expose a Service onto an external (outside of your cluster) IP address.

Kubernetes ServiceTypes allow you to specify what kind of service you want. The default is ClusterIP.

Type values and their behaviors are:

ClusterIP: Exposes the service on a cluster-internal IP. Choosing this value makes the service only reachable from within the cluster. This is the default ServiceType.
NodePort: Exposes the service on each Node’s IP at a static port (the NodePort). A ClusterIP service, to which the NodePort service will route, is automatically created. You’ll be able to contact the NodePort service, from outside the cluster, by requesting <NodeIP>:<NodePort>.
LoadBalancer: Exposes the service externally using a cloud provider’s load balancer. NodePort and ClusterIP services, to which the external load balancer will route, are automatically created.
ExternalName: Maps the service to the contents of the externalName field (e.g. foo.bar.example.com), by returning a CNAME record with its value. No proxying of any kind is set up. This requires version 1.7 or higher of kube-dns.
#+END_EXAMPLE
** Type: Loadbalancer
** Type: ClusterIP
** Type: NodePort
If you set the type field to "NodePort", the Kubernetes master will allocate a port from a flag-configured range (default: 30000-32767)
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO Now if i access IP:NodePort, will it balance the load across multiple pods ?
https://kubernetes.io/docs/tasks/access-application-cluster/load-balance-access-application-cluster/
#+BEGIN_EXAMPLE
Vivek Yadav [8:34 AM]
Hey Denny, quick question -

```
---
 apiVersion: v1
 kind: Service
 metadata:
   name: span
   labels:
     app: span
 spec:
   type: NodePort
   ports:
     - port: 80
       nodePort: 30080
   selector:
     app: spa

---
 apiVersion: apps/v1beta2
 kind: Deployment
 metadata:
   name: spa
 spec:
   replicas: 2
   selector:
     matchLabels:
       app: spa
   template:
     metadata:
       labels:
         app: spa
     spec:
       containers:
         - name: py
           image: viveky4d4v/local-simple-python:latest
           ports:
             - containerPort: 8080
         - name: nginx
           image: viveky4d4v/local-nginx-lb:latest
           ports:
             - containerPort: 80
       imagePullSecrets:
         - name: regsecret

```


Now if i access IP:NodePort, will it balance the load across multiple pods ?


Denny Zhang (Github . Blogger) [8:35 AM]
I don’t think so
#+END_EXAMPLE
** TODO How Does NodePort work behind the scene?
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO How Loadbalancer is implemented in code?
** #  --8<-------------------------- separator ------------------------>8-- :noexport:
** TODO Does Loadbalancer works only for public cloud?
** TODO How I configure Ingress?
* TODO [#A] NodePort VS clusterIP                                 :IMPORTANT:
https://stackoverflow.com/questions/41509439/whats-the-difference-between-clusterip-nodeport-and-loadbalancer-service-types
http://weezer.su/kubernetes-1.html
https://docs.openshift.com/container-platform/3.3/dev_guide/getting_traffic_into_cluster.html

clusterIP: You can only access this service while inside the cluster.
* #  --8<-------------------------- separator ------------------------>8-- :noexport:
* TODO [#A] k8s feature watch list
** I want to check pod initContainer logs, but I don't want to specify initContainer by name
#+BEGIN_EXAMPLE
macs-MacBook-Pro:Scenario-401 mac$ kubectl logs my-jenkins-jenkins-89889ddb7-ct7jw -c 1
Error from server (BadRequest): container 1 is not valid for pod my-jenkins-jenkins-89889ddb7-ct7jw
macs-MacBook-Pro:Scenario-401 mac$ kubectl logs my-jenkins-jenkins-89889ddb7-ct7jw -c  copy-default-config
Error from server (BadRequest): container "copy-default-config" in pod "my-jenkins-jenkins-89889ddb7-ct7jw" is waiting to start: PodInitializing
macs-MacBook-Pro:Scenario-401 mac$ kubectl logs my-jenkins-jenkins-89889ddb7-ct7jw -c  copy-default-config
Error from server (BadRequest): container "copy-default-config" in pod "my-jenkins-jenkins-89889ddb7-ct7jw" is waiting to start: PodInitializing
#+END_EXAMPLE
** Support using environment variables inside deployment yaml file
https://github.com/kubernetes/kubernetes/issues/52787
* TODO pod error: CreateContainerConfigError
https://github.com/kubernetes/minikube/issues/2256
#+BEGIN_EXAMPLE
bash-3.2$ kubectl get pod my-wordpress-wordpress-df987548d-btvf5
NAME                                     READY     STATUS                       RESTARTS   AGE
my-wordpress-wordpress-df987548d-btvf5   0/1       CreateContainerConfigError   0          2m
bash-3.2$
#+END_EXAMPLE

#+BEGIN_EXAMPLE
bash-3.2$ kubectl describe pod my-wordpress-wordpress-df987548d-btvf5
Name:           my-wordpress-wordpress-df987548d-btvf5
Namespace:      default
Node:           minikube/192.168.99.102
Start Time:     Fri, 05 Jan 2018 16:41:27 -0600
Labels:         app=my-wordpress-wordpress
                pod-template-hash=895431048
Annotations:    kubernetes.io/created-by={"kind":"SerializedReference","apiVersion":"v1","reference":{"kind":"ReplicaSet","namespace":"default","name":"my-wordpress-wordpress-df987548d","uid":"910e01e0-f269-11e7-b6d8...
Status:         Pending
IP:             172.17.0.6
Created By:     ReplicaSet/my-wordpress-wordpress-df987548d
Controlled By:  ReplicaSet/my-wordpress-wordpress-df987548d
Containers:
  my-wordpress-wordpress:
    Container ID:
    Image:          bitnami/wordpress:4.9.1-r1
    Image ID:
    Ports:          80/TCP, 443/TCP
    State:          Waiting
      Reason:       CreateContainerConfigError
    Ready:          False
    Restart Count:  0
    Requests:
      cpu:      300m
      memory:   512Mi
    Liveness:   http-get http://:http/wp-login.php delay=120s timeout=5s period=10s #success=1 #failure=6
    Readiness:  http-get http://:http/wp-login.php delay=30s timeout=3s period=5s #success=1 #failure=3
    Environment:
      ALLOW_EMPTY_PASSWORD:         yes
      MARIADB_ROOT_PASSWORD:        <set to the key 'mariadb-root-password' in secret 'my-wordpress-mariadb'>  Optional: false
      MARIADB_HOST:                 my-wordpress-mariadb
      MARIADB_PORT_NUMBER:          3306
      WORDPRESS_DATABASE_NAME:      bitnami_wordpress
      WORDPRESS_DATABASE_USER:      bn_wordpress
      WORDPRESS_DATABASE_PASSWORD:  <set to the key 'mariadb-password' in secret 'my-wordpress-mariadb'>  Optional: false
      WORDPRESS_USERNAME:           admin
      WORDPRESS_PASSWORD:           <set to the key 'wordpress-password' in secret 'my-wordpress-wordpress'>  Optional: false
      WORDPRESS_EMAIL:              contact@dennyzhang.com
      WORDPRESS_FIRST_NAME:         FirstName
      WORDPRESS_LAST_NAME:          LastName
      WORDPRESS_BLOG_NAME:          My DevOps Blog!
      SMTP_HOST:
      SMTP_PORT:
      SMTP_USER:
      SMTP_PASSWORD:                <set to the key 'smtp-password' in secret 'my-wordpress-wordpress'>  Optional: false
      SMTP_USERNAME:
      SMTP_PROTOCOL:
    Mounts:
      /bitnami/apache from wordpress-data (rw)
      /bitnami/php from wordpress-data (rw)
      /bitnami/wordpress from wordpress-data (rw)
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-tc8kd (ro)
Conditions:
  Type           Status
  Initialized    True
  Ready          False
  PodScheduled   True
Volumes:
  wordpress-data:
    Type:       PersistentVolumeClaim (a reference to a PersistentVolumeClaim in the same namespace)
    ClaimName:  my-wordpress-wordpress
    ReadOnly:   false
  default-token-tc8kd:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-tc8kd
    Optional:    false
QoS Class:       Burstable
Node-Selectors:  <none>
Tolerations:     <none>
Events:
  Type     Reason                 Age              From               Message
  ----     ------                 ----             ----               -------
  Normal   Scheduled              1m               default-scheduler  Successfully assigned my-wordpress-wordpress-df987548d-btvf5 to minikube
  Normal   SuccessfulMountVolume  1m               kubelet, minikube  MountVolume.SetUp succeeded for volume "pvc-910644d3-f269-11e7-b6d8-08002782d6cd"
  Normal   SuccessfulMountVolume  1m               kubelet, minikube  MountVolume.SetUp succeeded for volume "default-token-tc8kd"
  Normal   Pulled                 1s (x7 over 1m)  kubelet, minikube  Container image "bitnami/wordpress:4.9.1-r1" already present on machine
  Warning  Failed                 1s (x7 over 1m)  kubelet, minikube  Error: lstat /tmp/hostpath-provisioner/pvc-910644d3-f269-11e7-b6d8-08002782d6cd: no such file or directory
  Warning  FailedSync             1s (x7 over 1m)  kubelet, minikube  Error syncing pod
bash-3.2$
#+END_EXAMPLE
* TODO [#A] Certified Kubernetes Administrator (CKA)              :IMPORTANT:
https://www.cncf.io/certification/expert/

https://github.com/cncf/curriculum/blob/master/certified_kubernetes_administrator_exam_v1.8.0.pdf

It is an online, proctored, performance-based test that requires solving multiple issues from a command line.

Candidates have 3 hours to complete the tasks.
* TODO HPA: Horizontal Pod Autoscaler
* #  --8<-------------------------- separator ------------------------>8-- :noexport:
* HALF Difference in between selectors and labels
* TODO [#A] kubernetes mount a file to pod                        :IMPORTANT:
https://stackoverflow.com/questions/33415913/whats-the-best-way-to-share-mount-one-file-into-a-pod
https://www.linkedin.com/feed/update/urn:li:activity:6355445509146107904/
* TODO K8S label & Selector
https://github.com/dennyzhang/dennytest/tree/master/k8s_etcd
